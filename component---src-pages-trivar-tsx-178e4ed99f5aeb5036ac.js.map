{"version":3,"sources":["webpack://my-gatsby-site/./src/components/trivar/cards.tsx","webpack://my-gatsby-site/./src/components/trivar/scatterPlot.tsx","webpack://my-gatsby-site/./src/components/trivar/scatterView.tsx","webpack://my-gatsby-site/./src/components/trivar/map.tsx","webpack://my-gatsby-site/./src/components/trivar/mapView.tsx","webpack://my-gatsby-site/./src/pages/trivar.tsx","webpack://my-gatsby-site/./src/utility/mapZoom.ts"],"names":["Container","styled","Title","Text","Row","Card","title","hcount","ccount","hrecent","crecent","MapContainer","getStateFips","fips","Number","String","slice","ScatterPlot","data","selectedState","size","margin","height","d3Container","useRef","useEffect","svg","d3","current","map_g","attr","append","xAxis","domain","range","call","yAxis","width","text","dataToPlot","Object","values","map","d","count","hot","cold","x","recent","y","reduce","result","key","push","getData","line","selectAll","sequential","enter","coldScale","hotScale","style","undefined","find","f","sel","arr","countiesInState","countiesInPoint","filter","_","i","avg","length","a","b","ref","ScatterView","useContext","LisaContext","mapData","mapTitles","county","MapSettings","countiesMap","highlightedState","highlightedCounty","addState","stateSelector","countySelector","time","colorScales","getRadius","translate","scale","projection","map_path","MapZoom","topojson","objects","states","features","id","counties","geometries","val","properties","name","on","county_path","datum","centroid","sparse","event","this","getAttribute","Button","LegendContainer","Legend","Cards","MapView","selectedCounty","setSelectedCounty","setSelectedState","setTime","useState","Array","mapZoom","setMapZoom","zoomScale","setZoomScale","reset","zooming","forEach","m","currId","select","Sparse","n","Math","max","countContainer","maxHeight","maxWidth","min","pointData","r","remove","ticks","tickFormat","recentContainer","weekValues","keys","w","c","mapNum","onClick","path","g","active","_d","bounds","x0","y0","x1","y1","dx","dy","scaleNew","translateNew","transition","duration","clicked","stateId","node","classed"],"mappings":"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","file":"component---src-pages-trivar-tsx-178e4ed99f5aeb5036ac.js","sourcesContent":["import React from \"react\";\nimport styled from \"styled-components\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  border-radius: 10px;\n  background-color: lightgray;\n  width: 170px;\n  margin: 5px;\n  padding: 5px;\n`;\n\nconst Title = styled.h3`\n  margin: 0 0 10px 0;\n`;\n\nconst Text = styled.p`\n  margin: 0;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\ntype Props = {\n  title: string;\n  hcount: number;\n  ccount: number;\n  hrecent: number;\n  crecent: number;\n};\n \nexport default function Card({\n  title,\n  hcount,\n  ccount,\n  hrecent,\n  crecent,\n}: Props) {\n  return (\n    <Container>\n      <Title>{title}</Title>\n      <Row>\n        <Text># Hot Spots:</Text> <Text>{hcount}</Text>\n      </Row>\n      <Row>\n        <Text># Cold Spots:</Text><Text>{ccount}</Text>\n      </Row>\n      <Row>\n        <Text>Last Hot Spot:</Text><Text>{hrecent}</Text>\n      </Row>\n      <Row>\n        <Text>Last Cold Spot:</Text><Text>{crecent}</Text>\n      </Row>\n    </Container>\n  );\n}\n","import React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\n\nimport Sparse from \"../../utility/sparse\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  margin: 10px;\n`;\n\nconst Title = styled.h3`\n  margin: 0;\n`;\n\nconst MapContainer = styled.svg``;\n\nconst getData = (data) =>\n  Object.values(\n    data\n      .map((d) => {\n        const [hot, cold] = d.count();\n        return {\n          x:\n            (hot > cold ? d.recent()[0] : d.recent()[1]),\n          y: hot > cold ? hot : cold,\n          hot: hot > cold,\n          fips: d.fips,\n        };\n      })\n      .reduce((result, { x, y, fips, hot }) => {\n        const key = `${x},${y}`;\n\n        if (key in result) {\n          result[key].fips.push(fips);\n          result[key].hot.push(hot);\n        } else {\n          result[key] = {\n            x,\n            y,\n            fips: [fips],\n            hot: [hot],\n          };\n        }\n        return result;\n      }, {})\n  );\n\nconst getStateFips = (fips: number): number => {\n  return Number(String(fips).slice(0, -3));\n};\n\ntype Props = {\n  title: string;\n  selectedState: [number, string];\n  data: Array<Sparse>;\n};\n\nconst average = (arr: Array<number>) => {\n  return arr.reduce((a, b) => a + b) / arr.length;\n};\n\nconst subset = (vals: Array<number>, sel: Array<boolean>) => {\n  return vals.filter((_, i) => sel[i])\n}\n\nexport default function ScatterPlot({\n  data,\n  title,\n  selectedState,\n}: Props) {\n  const size = 380;\n  const scale = 1;\n  const margin = [50, 50];\n\n  const height = size - 2 * 50;\n  const width = size - 2 * 50;\n\n  const d3Container = useRef(null);\n\n  useEffect(() => {\n    const svg = d3.select(d3Container.current);\n\n    const map_g = svg\n      .attr(\"width\", size)\n      .attr(\"height\", size)\n      .append(\"g\")\n      .attr(\"scale\", 10)\n      .attr(\"transform\", `translate(${margin})`);\n\n    const xAxis = d3.scaleLinear().domain([0, 52]).range([0, width]);\n\n    map_g\n      .append(\"g\")\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(d3.axisBottom(xAxis));\n\n    const yAxis = d3.scaleLinear().domain([0, 52]).range([height, 0]);\n\n    map_g.append(\"g\").call(d3.axisLeft(yAxis));\n\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", width / 2 + 100)\n      .attr(\"y\", height + 85)\n      .text(\"Week Number\");\n\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", -35 - height / 2)\n      .attr(\"y\", 10)\n      .attr(\"dy\", \"0.75em\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .text(\"Count\");\n\n    const dataToPlot = getData(data);\n\n    const line = d3\n      .line()\n      .x(({ x }) => xAxis(x))\n      .y(({ y }) => yAxis(y));\n\n    // lines\n    // does all calculations at once then turns on later\n    map_g\n      .selectAll(\"myLines\")\n      .data(\n        data.map((d) => {\n          const [hot, cold] = d.count();\n          return {\n            data: hot > cold ? d.sequential(1) : d.sequential(2),\n            hot: hot > cold,\n            fips: d.fips,\n          };\n        })\n      )\n      .enter()\n      .append(\"path\")\n      .attr(\"class\", \"seq\")\n      .attr(\"stroke\", \"none\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke-width\", 1.5)\n      .attr(\"stroke-opacity\", 0.15)\n      .attr(\"d\", (d) => line(d.data));\n\n    map_g\n      .selectAll(\"dot\")\n      .data(dataToPlot)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", \"point\")\n      .attr(\"cx\", ({ x }) => xAxis(x))\n      .attr(\"cy\", ({ y }) => yAxis(y))\n      .attr(\"r\", 2)\n  }, []);\n\n  useEffect(() => {\n    const coldScale = d3.interpolateBlues;\n    const hotScale = d3.interpolateReds;\n\n    d3.select(d3Container.current)\n      .selectAll(\".point\")\n      .style(\"fill-opacity\", ({ fips }) => {\n        return selectedState[0] === -1 ||\n          fips.find((f) => getStateFips(f) === selectedState[0]) !== undefined\n          ? 1\n          : 0.1;\n      })\n      .style(\"fill\", ({ hot, fips }) => {\n        const countiesInState = fips.map(f => selectedState[0] === -1 || getStateFips(f) === selectedState[0]);\n        const countiesInPoint = subset(hot, countiesInState)\n        const avg = average(countiesInPoint.length ? countiesInPoint : hot);\n        return avg > 0.5 ? hotScale(avg) : coldScale(1 - avg); // make sure 1 - avg never is 0\n      });\n\n    d3.select(d3Container.current)\n      .selectAll(\".seq\")\n      .style(\"stroke\", ({ fips, hot }) => {\n        return getStateFips(fips) === selectedState[0] ? (hot ? \"#FF0000\" : \"#0000FF\") : \"none\";\n      });\n  }, [selectedState]);\n\n  return (\n    <Container>\n      <Title>{title}</Title>\n      <MapContainer ref={d3Container} />\n    </Container>\n  );\n}\n","import React, { useContext } from \"react\";\nimport styled from \"styled-components\";\n\nimport Sparse from \"../../utility/sparse\";\nimport ScatterPlot from \"./scatterPlot\";\nimport { LisaContext } from \"../../contexts/lisaContext\"\n\ntype Props = {\n  selectedState: [number, string];\n};\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: center;\n`;\n\nexport default function ScatterView({\n  selectedState\n}: Props) {\n  const { mapData, mapTitles } = useContext(LisaContext)\n  return (\n    <Container>\n      {mapTitles.map((title, i) => {\n        return (\n          <ScatterPlot\n            key={i}\n            title={title}\n            selectedState={selectedState}\n            data={mapData ? mapData[i] : null}\n          />\n        );\n      })}\n    </Container>\n  );\n}\n","import React, { useRef, useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\n\nimport MapZoom from \"../../utility/mapZoom\";\nimport Sparse from \"../../utility/sparse\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  margin: 10px;\n`;\n\nconst Title = styled.h3`\n  margin: 0;\n`;\n\nconst MapContainer = styled.svg`\n  g {\n    background-color: light-gray;\n    fill: red;\n  }\n  border: 1px solid black;\n\n  #c${({ county }: { county: number }) => county}.cboundary {\n    stroke: black;\n    stroke-width: 0.25px;\n  }\n\n  .cboundary {\n    stroke-width: 0px;\n    fill: #ffffff00;\n  }\n\n  .bubble {\n    stroke-width: 0;\n  }\n`;\n\nconst getStateFips = (fips: number): number => {\n  return Number(String(fips).slice(0, -3));\n};\n\ntype MapSettings = {\n  width: number;\n  height: number;\n  translate: [number, number];\n  scale: number;\n};\n\ntype Data = Array<Sparse>;\n\ninterface Props {\n  title: string;\n  MapSettings: MapSettings;\n  countiesMap: any;\n  highlightedState: [number, string];\n  highlightedCounty: [number, string];\n  addState: (m: MapZoom) => void;\n  stateSelector: ([s, s1]: [number, string], b?: boolean) => boolean;\n  countySelector: ([s, s1]: [number, string]) => void;\n  data: Data;\n  time: [number, number];\n  colorScales: [any, any];\n  getRadius: (g: Sparse) => number;\n}\n\nconst Map = ({\n  title,\n  MapSettings,\n  countiesMap,\n  highlightedState,\n  highlightedCounty,\n  addState,\n  stateSelector,\n  countySelector,\n  data,\n  time,\n  colorScales: [hotScale, coldScale],\n  getRadius,\n}: Props) => {\n  const { width, height, translate, scale } = MapSettings;\n\n  const d3Container = useRef(null);\n\n  const projection = d3.geoAlbers().scale(scale).translate(translate);\n  const map_path = d3.geoPath().projection(projection);\n\n  useEffect(() => {\n    const map_g = d3\n      .select(d3Container.current)\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .append(\"g\");\n\n    addState(new MapZoom(map_path, map_g, width, height, highlightedState[0]));\n\n    // States:\n    map_g\n      .append(\"g\")\n      .style(\"stroke\", \"black\")\n      .style(\"stroke-width\", \"0.5px\")\n      .style(\"fill\", \"#ffffffff\")\n      .selectAll(\"path\")\n      .data(topojson.feature(countiesMap, countiesMap.objects.states).features)\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", map_path as any)\n      .attr(\"stateFips\", ({ id }) => Number(id));\n\n    // Counties:\n    map_g\n      .append(\"g\")\n      .selectAll(\"path\")\n      .data(\n        topojson.feature(countiesMap, countiesMap.objects.counties).features\n      )\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", map_path as any)\n      .attr(\"stateName\", ({ id }) => {\n        return countiesMap.objects.states.geometries.filter((val) => {\n          return getStateFips(id) === Number(val.id);\n        })[0].properties.name;\n      })\n      .attr(\"id\", ({ id }) => `c${Number(id)}`)\n      //   .attr(\"countyName\", ({ properties: { name } }) => name)\n      .attr(\"class\", \"cboundary\")\n      .on(\"mouseout\", () => {\n        countySelector([-1, \"\"]);\n      });\n\n    // County Circles:\n    map_g\n      .selectAll(\"circle\")\n      .data(data)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", \"bubble\")\n      /* \n        HAVE TO LOAD COUNTY AND STATE NAME TO BUBBLES HERE:\n          MAYBE PUT THOSE AS SPARSE VECTOR INFO\n      */\n      .attr(\"countyName\", ({ fips }) => {\n        return countiesMap.objects.counties.geometries.filter(({ id }) => {\n          return fips === Number(id);\n        })[0].properties.name;\n      })\n      .attr(\"stateName\", ({ fips }) => {\n        return countiesMap.objects.states.geometries.filter(({ id }) => {\n          return getStateFips(fips) === Number(id);\n        })[0].properties.name;\n      })\n      .attr(\"transform\", ({ fips }) => {\n        const county_path = d3.select(`#c${fips}`).datum();\n        return `translate(${map_path.centroid(county_path)})`;\n      })\n      .on(\"mouseout\", () => {\n        countySelector([-1, \"\"]);\n      });\n  }, []);\n\n  useEffect(() => {\n    d3.selectAll(\".bubble\")\n      .attr(\"r\", getRadius)\n      .style(\"fill\", (sparse) => {\n        const [hot, cold] = sparse.recent(...time);\n        return hot > cold ? hotScale(hot) : coldScale(cold);\n      });\n  }, [time]);\n\n  useEffect(() => {\n    d3.selectAll(\".cboundary\").on(\"click\", function (event, { id }) {\n      stateSelector([getStateFips(id), this.getAttribute(\"stateName\")]);\n    });\n\n    d3.selectAll(\".cboundary\").on(\n      \"mouseover\",\n      function (event, { id, properties: { name } }) {\n        if (highlightedState[1] !== \"\") {\n          countySelector([Number(id), name]);\n        }\n      }\n    );\n\n    d3.selectAll(\".bubble\")\n      .on(\"mouseover\", function (_, { fips }) {\n        if (!highlightedState) {\n          return;\n        }\n        // console.log(getStateFips(d.fips), highlightedState[0])\n        if (highlightedState[1] !== \"\") {\n          countySelector([fips, this.getAttribute(\"countyName\")]);\n        }\n      })\n      .on(\"click\", function (event, { fips }) {\n        stateSelector([getStateFips(fips), this.getAttribute(\"stateName\")]);\n      })\n      .style(\"fill-opacity\", ({ fips }) => {\n        return highlightedState[0] === -1 ||\n          getStateFips(fips) === highlightedState[0]\n          ? 1\n          : 0.2;\n      });\n  }, [highlightedState]);\n\n  return (\n    <Container>\n      <Title>{title}</Title>\n      <MapContainer ref={d3Container} county={highlightedCounty[0]} />\n    </Container>\n  );\n};\n\nexport default Map;\n","import React, { useRef, useEffect, useState, useContext } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\n\n//import us from \"us-atlas/nation-10m.json\"\nimport counties from \"us-atlas/counties-10m.json\";\nimport states from \"us-atlas/states-10m.json\";\n//import data from \"../data/counties.json\";\n\nimport MapZoom from \"../../utility/mapZoom\";\nimport Sparse from \"../../utility/sparse\";\nimport Card from \"./cards\";\nimport Map from \"./map\";\nimport { LisaContext } from \"../../contexts/lisaContext\"\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst MapContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n\n  width: 100%;\n  flex-wrap: wrap;\n\n  @media (max-width: 770px) {\n    flex-wrap: wrap;\n  }\n`;\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n\n  width: 100%;\n  flex-wrap: wrap;\n`;\n\nconst Text = styled.p`\n  margin: 0;\n  width: 100px;\n  white-space: nowrap;\n`;\n\nconst Button = styled.button`\n  width: 50px;\n`;\n\nconst LegendContainer = styled.div`\n  width: 800px;\n  display: flex;\n  height: auto;\n`;\n\nconst Legend = styled.div`\n  margin: 10px;\n  width: 390px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Cards = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  flex-wrap: wrap;\n  width: 70%;\n`;\n\ntype MapSettings = {\n  width: number;\n  height: number;\n  translate: [number, number];\n  scale: number;\n};\n\ntype Data = Array<Sparse>;\n\ntype Props = {\n  MapSettings: MapSettings;\n  selectedCounty: [number, string];\n  setSelectedCounty: ([s1, s2]: [number, string]) => void;\n  selectedState: [number, string];\n  setSelectedState: ([s1, s2]: [number, string]) => void;\n  time: [number, number];\n  setTime: ([n1, n2]: [number, number]) => void;\n};\n\nconst getStateFips = (fips: number): number => {\n  return Number(String(fips).slice(0, -3));\n};\n\nexport default function MapView({\n  MapSettings,\n  selectedCounty,\n  setSelectedCounty,\n  selectedState,\n  setSelectedState,\n  time,\n  setTime,\n}: Props) {\n  const { mapData, mapTitles } = useContext(LisaContext)\n\n  const [mapZoom, setMapZoom] = useState(Array<MapZoom>(mapTitles.length));\n\n  const addState = (m: MapZoom, mapNum: number) => {\n    mapZoom[mapNum] = m;\n    setMapZoom(mapZoom);\n  };\n\n  const [zoomScale, setZoomScale] = useState(1);\n\n  const stateSelector = (\n    [id, name]: [number, string],\n    reset: boolean = false\n  ) => {\n    let zooming: boolean;\n\n    mapZoom.forEach((m) => {\n      if (!reset && id !== m.currId && id !== -1) {\n        setZoomScale(m.select(id));\n        zooming = true;\n      } else {\n        m.reset();\n        setZoomScale(1);\n        zooming = false;\n      }\n    });\n\n    if (zooming) {\n      setSelectedState([id, name]);\n      return true;\n    } else {\n      setSelectedState([-1, \"\"]);\n      return false;\n    }\n  };\n\n  const countySelector = ([id, name]: [number, string]) => {\n    if (id === -1 || getStateFips(id) === selectedState[0]) {\n      setSelectedCounty([id, name]);\n    }\n  };\n\n  const coldScale = d3\n    .scaleSequentialPow(d3.interpolateBlues)\n    .domain([...time]);\n  const hotScale = d3.scaleSequentialPow(d3.interpolateReds).domain([...time]);\n\n  const getRadius = (d: Sparse | number) => {\n    const val = d instanceof Sparse ? d.count(...time) : [d];\n    const n = d instanceof Sparse ? d.n : time[1];\n    return (30 + Math.max(...val)) / n;\n  };\n\n  const countContainer = useRef(null);\n\n  const maxHeight = 100;\n  const maxWidth = 380;\n  const margin = [20, 20];\n\n  useEffect(() => {\n    const width = Math.min(maxWidth, 100 + zoomScale * 10) - 2 * margin[0];\n    const height = Math.min(maxHeight, 40 + zoomScale * 2);\n\n    const pointData = [\n      { x: 1, r: 1 },\n      { x: 2, r: 5 },\n      { x: 3, r: 10 },\n      { x: 4, r: 20 },\n      { x: 5, r: 52 },\n    ];\n\n    d3.select(countContainer.current).selectAll(\"*\").remove();\n\n    const map_g = d3\n      .select(countContainer.current)\n      .style(\"width\", width + (7 / 2) * margin[0])\n      .style(\"height\", height + 2 * margin[1])\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin[0]},0)`);\n\n    const xAxis = d3.scaleLinear().domain([1, pointData[pointData.length - 1].x]).range([0, width]);\n    const yAxis = d3.scaleLinear().domain([0, 1]).range([height, 0]);\n\n    map_g\n      .append(\"g\")\n      .attr(\n        \"transform\",\n        `translate(0,${(margin[1] * 3) / 2 + (zoomScale * 5) / 2})`\n      )\n      .call(\n        d3\n          .axisBottom(xAxis)\n          .ticks(5)\n          .tickFormat((i) => String(pointData[i - 1].r))\n      );\n\n    map_g\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin[0]},0)`)\n      .call(d3.axisLeft(yAxis))\n      .style(\"display\", \"none\");\n\n    map_g\n      .selectAll(\"dot\")\n      .remove()\n      .data(pointData)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", \"point\")\n      .attr(\"cx\", ({ x }) => xAxis(x))\n      .attr(\"cy\", () => yAxis(0.5))\n      .attr(\"r\", ({ r }) => getRadius(r) * zoomScale)\n      .style(\"fill\", \"black\");\n\n    map_g\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", width / 2 + margin[0])\n      .attr(\"y\", height + (margin[1] * 3) / 2 + zoomScale / 4)\n      .text(\"Count\");\n  }, [time, zoomScale]);\n\n  const recentContainer = useRef(null);\n\n  useEffect(() => {\n    d3.select(recentContainer.current).selectAll(\"*\").remove();\n\n    const leftMargin = 30;\n\n    const map_g = d3\n      .select(recentContainer.current)\n      .style(\"width\", maxWidth)\n      .style(\"height\", maxHeight)\n      // .style(\"background-color\", \"lightgray\")\n      .append(\"g\")\n      .attr(\"transform\", `translate(${leftMargin + margin[0]},0)`);\n\n    const weekValues = [1, 5, 10, 15, 20, 25, 30, 40, 46, 52];\n\n    const pointData = [...Array(weekValues.length * 2).keys()].map((i) => {\n      return {\n        x: (i % weekValues.length) + 1,\n        w: weekValues[i % weekValues.length],\n        c: i < weekValues.length ? 1 : 2,\n      };\n    });\n\n    const xAxis = d3\n      .scaleLinear()\n      .domain([1, weekValues.length])\n      .range([0, maxWidth - 2 * margin[0] - leftMargin]);\n    const yAxis = d3\n      .scaleLinear()\n      .domain([0, 3])\n      .range([maxHeight - 2 * margin[1], 0]);\n\n    map_g\n      .append(\"g\")\n      .attr(\"transform\", `translate(0,${margin[1] + (maxHeight * 5) / 12})`)\n      .call(\n        d3\n          .axisBottom(xAxis)\n          .ticks(5)\n          .tickFormat((i) => String(pointData[i - 1].w))\n      );\n\n    map_g\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin[0]},0)`)\n      .call(d3.axisLeft(yAxis))\n      .style(\"display\", \"none\");\n\n    map_g\n      .selectAll(\"dot\")\n      .remove()\n      .data(pointData)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", \"point\")\n      .attr(\"cx\", ({ x }) => xAxis(x))\n      .attr(\"cy\", ({ c }) => yAxis(c))\n      .attr(\"r\", () => 9)\n      .style(\"fill\", ({ c, w }) => (c === 1 ? hotScale(w) : coldScale(w)));\n\n    map_g\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", maxWidth / 2 + leftMargin)\n      .attr(\"y\", (maxHeight * 19) / 20)\n      .text(\"Week Number\");\n\n    map_g\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", -leftMargin / 2)\n      .attr(\"y\", maxHeight / 2 - 5)\n      .text(\"Hot\");\n\n    map_g\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", -leftMargin / 2)\n      .attr(\"y\", maxHeight / 4)\n      .text(\"Cold\");\n  }, [time, zoomScale]);\n\n  // useEffect(() => {\n  //   d3\n  //     .select(d3Container.current)\n  //     .selectAll(\".point\")\n  //     .attr(\"r\", ({ r }) => getRadius(r) * zoomScale)\n  // }, [time, zoomScale])\n\n  return (\n    <Container>\n      <Text>Selected State: {selectedState[1]}</Text>\n      <MapContainer>\n        {mapTitles.map((title, i) => {\n          return (\n            <Map\n              key={i}\n              MapSettings={MapSettings}\n              title={title}\n              countiesMap={counties}\n              highlightedCounty={selectedCounty}\n              highlightedState={selectedState}\n              addState={(m: MapZoom) => addState(m, i)}\n              stateSelector={stateSelector}\n              countySelector={countySelector}\n              time={time}\n              data={mapData ? mapData[i] : null}\n              colorScales={[hotScale, coldScale]}\n              getRadius={getRadius}\n            />\n          );\n        })}\n      </MapContainer>\n      <Text>{selectedCounty[1] ? `Selected County: ${selectedCounty[1]} County` : \"\"}</Text>\n      <Cards>\n        {selectedCounty[0] !== -1\n          ? [0, 2, 1, 3].map((i) => {\n              const county = mapData\n                ? mapData[i].filter(\n                    (d) => Number(d.fips) === Number(selectedCounty[0])\n                  )[0]\n                : false;\n\n              const [hcount, ccount] = county ? county.count(...time) : [0, 0];\n              const [hrecent, crecent] = county\n                ? county.recent(...time)\n                : [0, 0];\n\n              return (\n                <Card\n                  key={i}\n                  title={mapTitles[i]}\n                  hcount={hcount}\n                  ccount={ccount}\n                  hrecent={hrecent}\n                  crecent={crecent}\n                />\n              );\n            })\n          : null}\n      </Cards>\n      <LegendContainer>\n        <Legend>\n          <svg ref={recentContainer} />\n        </Legend>\n        <Legend>\n          <svg ref={countContainer} />\n        </Legend>\n      </LegendContainer>\n      <Row>\n        <Button\n          onClick={() => {\n            stateSelector([-1, \"\"], true);\n          }}\n        >\n          Reset\n        </Button>\n      </Row>\n    </Container>\n  );\n}\n","import React, { useState, useContext } from \"react\";\nimport styled from \"styled-components\";\n\nimport MapView from \"../components/trivar/mapView\";\nimport ScatterView from \"../components/trivar/scatterView\";\nimport Slider from \"../components/trivar/slider\";\nimport Page from \"../components/page\";\n\nimport Sparse from \"../utility/sparse\";\n\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n`;\n\n\nconst Trivariate = () => {\n\n  const width = 380;\n  const height = 250;\n  const mapsTranslate: [number, number] = [width / 2, height / 2];\n  const mapsScale = 500;\n\n  const MapSettings = {\n    width,\n    height,\n    translate: mapsTranslate,\n    scale: mapsScale,\n  };\n\n  const [selectedCounty, setSelectedCounty] = useState<[number, string]>([\n    -1,\n    \"\",\n  ]);\n\n  const [selectedState, setSelectedState] = useState<[number, string]>([\n    -1,\n    \"\",\n  ]);\n\n  const [time, setTime] = useState<[number, number]>([0, 52])\n\n  return (\n    <Page>\n      <Container>\n        <MapView\n          MapSettings={MapSettings}\n          selectedCounty={selectedCounty}\n          setSelectedCounty={setSelectedCounty}\n          selectedState={selectedState}\n          setSelectedState={setSelectedState}\n          time={time}\n          setTime={setTime}\n        />\n        {/*<Slider time={time} setTime={setTime}/>*/}\n        {/*<p>State Selected: {selectedState[1]}</p>*/}\n        <hr style={{ width: \"100%\"}}/>\n        <ScatterView \n          selectedState={selectedState}\n          />\n      </Container>\n    </Page>\n  );\n};\n\nexport default Trivariate;\n","import * as d3 from \"d3\"\n\nexport default class MapZoom {\n    active = d3.select(null);\n    path = null\n    g = null\n    width = 0\n    height = 0\n    currId = -1\n\n    constructor(path, g, width, height, id) {\n        this.path = path\n        this.g = g;\n        this.width = width\n        this.height = height\n        this.currId = id\n    }\n\n    /*\n        Zoom in from id\n    */\n    select(id: number) {\n        this.currId = id;\n\n        const clicked = this.g.select(`[stateFips='${id}']`);\n\n        // this.active.classed(\"active\", false);\n        // this.active = clicked.classed(\"active\", true);\n\n        let d;\n        clicked.attr('x', (_d, i) => {\n            d = _d\n        })\n\n        const [[x0, y0], [x1, y1]] = this.path.bounds(d);\n\n        const dx = x1 - x0;\n        const dy = y1 - y0;\n        const x = (x0 + x1) / 2;\n        const y = (y0 + y1) / 2;\n\n        const scaleNew = 0.8 / Math.max(dx / this.width, dy / this.height);\n        const translateNew = [this.width / 2 - scaleNew * x, this.height / 2 - scaleNew * y]\n\n        this.g\n            .transition()\n            .duration(650)\n            .attr(\"transform\", `translate(${translateNew}) scale(${scaleNew})`)\n\n        return scaleNew\n    }\n\n    /*\n        On click event handler,\n\n\n        not used, WON'T WORK ANYMORE\n    */\n    clicked(clicked, d) {\n        const stateId = clicked.getAttribute(\"id\")\n        // const states = d3.selectAll(`[id='${stateId}']`)\n\n        if (this.active.node() === clicked) {\n            return this.reset();\n        }\n\n        this.active.classed(\"active\", false);\n        this.active = d3.select(clicked).classed(\"active\", true);\n\n        const [[x0, y0], [x1, y1]] = this.path.bounds(d);\n\n        const dx = x1 - x0;\n        const dy = y1 - y0;\n        const x = (x0 + x1) / 2;\n        const y = (y0 + y1) / 2;\n\n        const scaleNew = 0.7 / Math.max(dx / this.width, dy / this.height);\n        const translateNew = [this.width / 2 - scaleNew * x, this.height / 2 - scaleNew * y]\n\n        this.g\n            .transition()\n            .duration(650)\n            .attr(\"transform\", `translate(${translateNew}) scale(${scaleNew})`)\n\n        return stateId\n    }\n\n    /*\n        Reset map view\n    */\n    reset() {\n        this.currId = \"\"\n        this.active.classed(\"active\", false);\n        this.active = d3.select(null);\n\n        this.g\n            .transition()\n            .duration(500)\n            .attr(\"transform\", `translate(0)`)\n    }\n}"],"sourceRoot":""}