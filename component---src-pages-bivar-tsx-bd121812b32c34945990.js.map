{"version":3,"sources":["webpack://my-gatsby-site/./src/components/bivar/map.tsx","webpack://my-gatsby-site/./src/components/bivar/timeline.tsx","webpack://my-gatsby-site/./src/components/bivar/mapView.tsx","webpack://my-gatsby-site/./src/components/bivar/table.tsx","webpack://my-gatsby-site/./src/pages/bivar.tsx","webpack://my-gatsby-site/./src/utility/mapZoom.ts"],"names":["Container","styled","Title","MapContainer","border","getStateFips","fips","Number","String","slice","title","countiesMap","data","highlightedCounty","countySelector","MapSettings","time","weekNum","past","addState","stateSelector","selectedState","scale","translate","width","height","d3Container","useRef","projection","d3","map_path","useEffect","map_g","current","attr","append","MapZoom","style","selectAll","topojson","objects","states","features","enter","id","counties","geometries","filter","val","properties","name","forEach","d","col","opac","getLast","curr","last","weeks","Math","pow","sel","select","on","currentTarget","getAttribute","ref","Slider","ButtonArea","convertDate","Date","nextDate","initial","n","getTime","week","setWeek","playing","setPlaying","months","dates","useContext","DatesContext","map","labels","Array","keys","i","getDate","x","domain","length","range","clamp","update","find","newDate","endDate","text","getMonth","slider","insert","invert","this","parentNode","appendChild","cloneNode","call","interrupt","event","onClick","MapView","selectedCounty","setSelectedCounty","setTime","setSelectedState","useState","setPast","LisaContext","mapData","mapTitles","mapZoom","setMapZoom","reset","zooming","m","currId","timer","setInterval","clearInterval","type","value","onChange","htmlFor","key","MainTable","THead","THGroup","underLine","TH","TData","highlight","TRow","TBody","ColdLegend","HotLegend","LegendContainer","Legend","Table","colSpan","query","render","allRawCsv","nodes","node","cm","cs","sm","ss","cmVec","cmVal","undefined","get","csVec","csVal","smVec","smVal","ssVec","ssVal","selectedPage","path","g","active","_d","bounds","x0","y0","x1","y1","dx","dy","y","scaleNew","max","translateNew","transition","duration","clicked","stateId","classed"],"mappings":"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","file":"component---src-pages-bivar-tsx-bd121812b32c34945990.js","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\n\nimport Sparse from \"../../utility/sparse\";\nimport MapZoom from \"../../utility/mapZoom\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  margin: 10px;\n`;\n\nconst Title = styled.h3`\n  margin: 0;\n`;\n\nconst MapContainer = styled.svg`\n  g {\n    background-color: light-gray;\n    fill: red; // sjakldjsakldjsakljdsklajdkl <----------------------------------\n  }\n  border: 1px solid ${({ border }: { border: boolean }) => border ? \"black\" : \"white\"};\n  // background-color: #f5f5f5;\n`;\n\ntype MapData = Array<Sparse>;\n\ntype MapSettings = {\n  width: number;\n  height: number;\n  translate: [number, number];\n  scale: number;\n};\n\ninterface Props {\n  title: string;\n  countiesMap: any;\n  highlightedCounty: [number, string];\n  countySelector: ([s, s1]: [number, string]) => void;\n  data: MapData;\n  time: [number, number];\n  MapSettings: MapSettings;\n  weekNum: number;\n  past: boolean;\n  addState: (m: MapZoom) => void;\n  stateSelector: ([a, b]: [number, string]) => void;\n  selectedState: [number, string];\n}\n\nconst getStateFips = (fips: number): number => {\n  return Number(String(fips).slice(0, -3));\n};\nconst Map = ({\n  title,\n  countiesMap,\n  highlightedCounty,\n  countySelector,\n  data,\n  time,\n  MapSettings,\n  weekNum,\n  past,\n  addState,\n  stateSelector,\n  selectedState,\n}: Props) => {\n  const { scale, translate, width, height } = MapSettings;\n\n  const d3Container = useRef(null);\n\n  const projection = d3.geoAlbers().scale(scale).translate(translate);\n  const map_path = d3.geoPath().projection(projection);\n\n  useEffect(() => {\n    const map_g = d3\n      .select(d3Container.current)\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .append(\"g\");\n\n    addState(new MapZoom(map_path, map_g, width, height, selectedState[0]));\n\n    // States:\n    map_g\n      .append(\"g\")\n      .style(\"stroke\", \"black\")\n      .style(\"stroke-width\", \"0.5px\")\n      .style(\"fill\", \"#ffffffff\")\n      .selectAll(\"path\")\n      .data(topojson.feature(countiesMap, countiesMap.objects.states).features)\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", map_path as any)\n      .attr(\"stateFips\", ({ id }) => Number(id));\n\n    // Counties:\n    map_g\n      .append(\"g\")\n      .selectAll(\"path\")\n      .data(\n        topojson.feature(countiesMap, countiesMap.objects.counties).features\n      )\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", map_path as any)\n      .attr(\"stateName\", ({ id }) => {\n        return countiesMap.objects.states.geometries.filter((val) => {\n          return getStateFips(id) === Number(val.id);\n        })[0].properties.name;\n      })\n      .attr(\"id\", ({ id }) => `c${Number(id)}`)\n      //   .attr(\"countyName\", ({ properties: { name } }) => name)\n      .attr(\"class\", \"cboundary\")\n      .style(\"fill\", \"#00000000\");\n    // .style(\"stroke-width\", 0)\n    // .style(\"stroke\", \"#FFFFFF00\")\n  }, []);\n\n  useEffect(() => {\n    data.forEach((d) => {\n      const { curr, last, weeks } = d.getLast(weekNum);\n\n      let col, opac;\n\n      if (curr && curr !== 0) {\n        col = curr === 1 ? \"#fa5a50\" : \"#5768ac\";\n        opac = 1;\n      } else {\n        col = \"#00000000\";\n        if (last === 1) {\n          col = \"#ff0000\";\n        } else if (last === 2) {\n          col = \"#0000ff\";\n        }\n        opac = past ? (last > 0 && weeks > 0 ? Math.pow(4, -weeks) : 0) : 0;\n      }\n      opac *= Math.pow(\n        1 / 4,\n        1 -\n          Number(\n            getStateFips(d.fips) === selectedState[0] || selectedState[0] === -1\n          )\n      );\n\n      const sel = d3.select(d3Container.current).select(`#c${d.fips}`);\n      sel.style(\"fill\", col);\n      sel.style(\"fill-opacity\", opac);\n    });\n  }, [weekNum, past, selectedState]);\n\n  useEffect(() => {\n    d3.select(d3Container.current)\n      .selectAll(\".cboundary\")\n      .on(\"click\", function ({ currentTarget }, { id }) {\n        stateSelector([\n          getStateFips(id),\n          currentTarget.getAttribute(\"stateName\"),\n        ]);\n      });\n    // .style(\"fill-opacity\", function( { id }){\n    //   return getStateFips(id) === selectedState[0] || selectedState[0] === -1 ? \"1\" : \"0.3\"\n    // })\n  }, [selectedState]);\n\n  return (\n    <Container>\n      <Title>{title}</Title>\n      <MapContainer ref={d3Container} border={selectedState[0] !== -1}/>\n    </Container>\n  );\n};\n\nexport default Map;\n","import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\n\nimport { DatesContext } from \"../../contexts/datesContext\";\n\nconst Container = styled.div`\n  width: 700px;\n  height: 150px;\n`;\n\nconst Slider = styled.svg`\n  width: 100%;\n  height: 90px;\n`;\n\nconst ButtonArea = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: center;\n\n  * {\n    margin: 20px;\n  }\n`;\n\ntype Props = {\n  week: number;\n  setWeek: (number) => void;\n  playing: boolean;\n  setPlaying: (b: boolean) => void;\n};\n\nconst convertDate = (d: string): Date => {\n  return new Date(`${d} PST`);\n};\n\nconst nextDate = (initial: Date, n: number) => {\n  // return new Date(\n  //   initial.getFullYear(),\n  //   initial.getMonth(),\n  //   initial.getDate() + n\n  // );\n\n  return new Date(initial.getTime() + 24 * 60 * 60 * 1000 * n);\n};\n\nconst TimeLine = ({ week, setWeek, playing, setPlaying }: Props) => {\n  const months = [\n    \"Jan\",\n    \"Feb\",\n    \"Mar\",\n    \"Apr\",\n    \"May\",\n    \"Jun\",\n    \"Jul\",\n    \"Aug\",\n    \"Sep\",\n    \"Oct\",\n    \"Nov\",\n    \"Dec\",\n  ];\n\n  const dates = useContext(DatesContext).map((d) => convertDate(d));\n\n  // 2020 was a leap year...\n  const labels = [...Array(365).keys()]\n    .map((i) => {\n      return { d: nextDate(dates[0], i), i };\n    })\n    .filter(({ d }) => {\n      return d.getDate() === 1;\n    });\n\n  const d3Container = useRef(null);\n\n  const x = d3\n    .scaleTime()\n    .domain([dates[0], dates[dates.length - 1]])\n    .range([0, 600])\n    .clamp(true);\n\n  const update = (val: Date | number) => {\n    let i: number;\n\n    if (val instanceof Date) {\n      i = [...Array(dates.length).keys()].find((i) => {\n        return (\n          dates[i] > val ||\n          i === dates.length - 1 ||\n          (dates[i] >= val && i === 0)\n        );\n      });\n      setWeek(i);\n    } else {\n      i = val;\n    }\n\n    const newDate = dates[i];\n    const endDate =\n      i + 1 < dates.length\n        ? nextDate(dates[i + 1], -1)\n        : convertDate(\"2020-12-27\");\n\n    d3.select(d3Container.current).select(\"#handle\").attr(\"cx\", x(newDate));\n    d3.select(d3Container.current)\n      .select(\"#label\")\n      .attr(\"x\", x(newDate))\n      .text(\n        `${newDate.getMonth() + 1}/${newDate.getDate()} - ${\n          endDate.getMonth() + 1\n        }/${endDate.getDate()}`\n      );\n  };\n\n  useEffect(() => {\n    const svg = d3\n      .select(d3Container.current)\n      .append(\"svg\")\n      .attr(\"width\", 700)\n      .attr(\"height\", 100);\n\n    const slider = svg.append(\"g\").attr(\"transform\", \"translate(55, 50)\");\n\n    slider\n      .insert(\"g\")\n      .selectAll(\"text\")\n      .data(labels)\n      .enter()\n      .append(\"text\")\n      .attr(\"x\", ({ d }) => x(d))\n      .attr(\"y\", 30)\n      .attr(\"text-anchor\", \"middle\")\n      .text(({ d }) => months[d.getMonth()]);\n\n    slider\n      .append(\"text\")\n      .attr(\"x\", x(x.invert(600)))\n      .attr(\"y\", 30)\n      .text(\"2020\");\n\n    const handle = slider.insert(\"circle\").attr(\"id\", \"handle\").attr(\"r\", 9);\n\n    const label = slider\n      .append(\"text\")\n      .attr(\"id\", \"label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", \"translate(0,-15)\");\n\n    slider\n      .append(\"line\")\n      .attr(\"stroke\", \"black\")\n      .attr(\"stroke-width\", \"10px\")\n      .attr(\"stroke-opacity\", 0.3)\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"x1\", x.range()[0])\n      .attr(\"x2\", x.range()[1])\n      .select(function () {\n        return this.parentNode.appendChild(this.cloneNode(true));\n      })\n      .attr(\"stroke-width\", \"100px\") // want this to overlap the text\n      .attr(\"stroke\", \"transparent\")\n      .call(\n        d3\n          .drag()\n          .on(\"start.interrupt\", () => slider.interrupt())\n          .on(\"start drag\", (event) => {\n            setPlaying(false);\n            update(x.invert(event.x));\n          })\n      );\n  }, []);\n\n  useEffect(() => {\n    update(week);\n  }, [week]);\n\n  return (\n    <Container>\n      <Slider ref={d3Container} />\n      <ButtonArea>\n        <button\n          onClick={() => {\n            if (week > 0) {\n              setWeek(week - 1);\n            }\n            setPlaying(false);\n          }}\n        >\n          Prev\n        </button>\n        <button\n          onClick={() => {\n            setPlaying(!playing);\n          }}\n        >\n          {playing ? \"Pause\" : \"Play\"}\n        </button>\n        <button\n          onClick={() => {\n            if (week < 51) {\n              setWeek(week + 1);\n            }\n            setPlaying(false);\n          }}\n        >\n          Next\n        </button>\n      </ButtonArea>\n    </Container>\n  );\n};\n\nexport default TimeLine;\n","import React, { useEffect, useContext, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\n\nimport counties from \"us-atlas/counties-10m.json\";\n\nimport { LisaContext } from \"../../contexts/lisaContext\";\nimport Sparse from \"../../utility/sparse\";\nimport Map from \"./map\";\nimport TimeLine from \"./timeline\";\nimport MapZoom from \"../../utility/mapZoom\";\n\ntype Data = Array<Sparse>;\n\ntype MapSettings = {\n  width: number;\n  height: number;\n  translate: [number, number];\n  scale: number;\n};\n\ntype Props = {\n  selectedCounty: [number, string];\n  setSelectedCounty: ([s1, s2]: [number, string]) => void;\n  MapSettings: MapSettings;\n  time: [number, number];\n  setTime: ([n1, n2]: [number, number]) => void;\n  week: number;\n  setWeek: (n: number) => void;\n  selectedState: [number, string];\n  setSelectedState: ([a, b]: [number, string]) => void;\n};\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst Text = styled.p`\n  margin: 0;\n  width: 100px;\n  white-space: nowrap;\n`;\nconst MapContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n\n  width: 100%;\n  flex-wrap: wrap;\n\n  @media (max-width: 770px) {\n    flex-wrap: wrap;\n  }\n`;\nexport default function MapView({\n  selectedCounty,\n  setSelectedCounty,\n  MapSettings,\n  time,\n  setTime,\n  week,\n  setWeek,\n  selectedState,\n  setSelectedState,\n}: Props) {\n  const [past, setPast] = useState(false);\n\n  const { mapData, mapTitles } = useContext(LisaContext);\n\n  const [playing, setPlaying] = useState(false);\n\n  const [mapZoom, setMapZoom] = useState(Array<MapZoom>(4));\n\n  const addState = (m: MapZoom, i) => {\n    mapZoom[i] = m;\n    setMapZoom(mapZoom);\n  };\n\n  const stateSelector = (\n    [id, name]: [number, string],\n    reset: boolean = false\n  ) => {\n    let zooming: boolean;\n\n    mapZoom.forEach((m) => {\n      if (!reset && id !== m.currId && id !== -1) {\n        m.select(id);\n        zooming = true;\n      } else {\n        m.reset();\n        zooming = false;\n      }\n    });\n\n    if (zooming) {\n      setSelectedState([id, name]);\n      return true;\n    } else {\n      setSelectedState([-1, \"\"]);\n      return false;\n    }\n  };\n\n  useEffect(() => {\n    if (!playing) {\n      return;\n    }\n\n    const timer = setInterval(() => {\n      if (week < 51) {\n        setWeek(week + 1);\n      }\n    }, 500);\n    return () => clearInterval(timer);\n  }, [playing, week]);\n\n  return (\n    <Container>\n      <div>\n        <form>\n          <input\n            type=\"checkbox\"\n            id=\"1\"\n            name=\"here\"\n            value=\"sad\"\n            onChange={() => setPast(!past)}\n          ></input>\n          <label htmlFor=\"1\">Show Past Values</label>\n        </form>\n      </div>\n      <MapContainer>\n        {mapTitles.map((title, i) => {\n          return (\n            <Map\n              key={i}\n              title={title}\n              countiesMap={counties}\n              highlightedCounty={selectedCounty}\n              countySelector={setSelectedCounty}\n              selectedState={selectedState}\n              stateSelector={stateSelector}\n              addState={(m: MapZoom) => addState(m, i)}\n              time={time}\n              data={mapData ? mapData[i] : null}\n              weekNum={week}\n              MapSettings={MapSettings}\n              past={past}\n            />\n          );\n        })}\n      </MapContainer>\n      <TimeLine\n        week={week}\n        setWeek={setWeek}\n        playing={playing}\n        setPlaying={setPlaying}\n      />\n    </Container>\n  );\n}\n","import React, { useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { LisaContext } from \"../../contexts/lisaContext\";\n\nimport { graphql, StaticQuery } from \"gatsby\";\nimport counties from \"us-atlas/counties-10m.json\";\nimport { rgb } from \"d3-color\";\n\nconst MainTable = styled.table`\n  border-collapse: collapse;\n  width: 760px;\n`;\n\nconst THead = styled.thead``;\n\nconst THGroup = styled.th`\n  text-align: center;\n  ${({ underLine }: { underLine: boolean }) => {\n    return underLine\n      ? \"border-bottom: 1px solid black; border-left: 20px solid white; border-right: 20px solid white;\"\n      : null;\n  }}\n`;\n\nconst TH = styled.th`\n  text-align: center;\n  border-bottom: 1px solid black;\n`;\n\nconst TData = styled.td`\n  background-color: ${({ highlight }: { highlight: string }) => {\n    if (highlight === \"hot\") {\n      return \"#5768acAA\";\n    } else if (highlight === \"cold\") {\n      return \"#fa5a50AA\";\n    }\n    return \"#FFFFFF00\";\n  }};\n  padding: 0;\n  margin: 0;\n`;\n\nconst TRow = styled.tr``;\n\nconst TBody = styled.tbody`\n  ${TRow} > *:nth-child(2n+1) {\n    width: 10px;\n    padding: 2px;\n  }\n\n  ${TRow} > * {\n    text-align: right;\n  }\n\n  & > ${TRow}:hover {\n    background-color: #d3d3d3;\n  }\n\n  ${TRow} > *:nth-child(2n) {\n    width: 100px;\n  }\n\n  ${TRow} > *:nth-child(1) {\n    width: 130px;\n    text-align: left;\n    border-right: 1px solid black;\n  }\n\n  ${TRow} > *:nth-child(3) {\n    // secondary line\n    // border-right: 1px solid lightgray;\n  }\n\n  ${TRow} > *:nth-child(7) {\n    // secondary line\n    // border-right: 1px solid lightgray;\n  }\n\n  ${TRow} > *:nth-child(5) {\n    border-right: 1px solid black;\n  }\n\n  ${TRow} {\n    border-bottom: 1px solid rgb(205, 205, 205);\n  }\n\n  ${TRow}:last-child {\n    border-bottom: 1px solid black;\n  }\n`;\n\nconst ColdLegend = styled.p`\n//  background-color: rgba(0, 0, 255, 0.4);\n  background-color: #fa5a50AA;\n`;\n\nconst HotLegend = styled.p`\n//  background-color: rgba(255, 0, 0, 0.4);\n  background-color: #5768acAA;\n`;\n\nconst LegendContainer = styled.div`\n  display: flex;\n  justify-content: flex-end;\n`;\n\nconst Legend = styled.div`\n  display: flex;\n  & > * {\n    margin: 5px;\n    padding: 5px;\n  }\n`;\n\ntype Props = {\n  selectedState: [number, string];\n  week: number;\n};\n\nconst getStateFips = (fips: number): number => {\n  return Number(String(fips).slice(0, -3));\n};\n\nexport default function Table({ selectedState, week }: Props) {\n  const { mapData, mapTitles } = useContext(LisaContext);\n\n  return (\n    <div>\n      <MainTable>\n        <THead>\n          <TRow>\n            <THGroup underLine={false}>Counties of</THGroup>\n            <THGroup colSpan={4} underLine={true}>\n              Mobility\n            </THGroup>\n            <THGroup colSpan={4} underLine={true}>\n              Sheltered\n            </THGroup>\n          </TRow>\n          <TRow>\n            <TH>{selectedState[1]}</TH>\n            <TH colSpan={2}>Cuebiq*</TH>\n            <TH colSpan={2}>SafeGraph</TH>\n            <TH colSpan={2}>Cuebiq</TH>\n            <TH colSpan={2}>SafeGraph</TH>\n          </TRow>\n        </THead>\n        <TBody>\n          <StaticQuery\n            query={graphql`\n              {\n                allRawCsv {\n                  nodes {\n                    cm\n                    cs\n                    fips\n                    sm\n                    ss\n                    week\n                  }\n                }\n              }\n            `}\n            render={({ allRawCsv: { nodes } }) => {\n              return nodes\n                .filter(\n                  (node) =>\n                    Number(node.week) - 1 === week &&\n                    getStateFips(node.fips) === selectedState[0]\n                )\n                .map(({ fips, cm, cs, sm, ss }, i) => {\n                  const cmVec = mapData[0].find((d) => d.fips === Number(fips));\n                  const cmVal = cmVec !== undefined ? cmVec.get(week) : 0;\n\n                  const csVec = mapData[1].find((d) => d.fips === Number(fips));\n                  const csVal = csVec !== undefined ? csVec.get(week) : 0;\n\n                  const smVec = mapData[2].find((d) => d.fips === Number(fips));\n                  const smVal = smVec !== undefined ? smVec.get(week) : 0;\n\n                  const ssVec = mapData[3].find((d) => d.fips === Number(fips));\n                  const ssVal = ssVec !== undefined ? ssVec.get(week) : 0;\n\n                  return (\n                    <TRow key={fips}>\n                      <TData highlight=\"none\">\n                        {\n                          counties.objects.counties.geometries.find(\n                            ({ id }) => Number(id) === Number(fips)\n                          ).properties.name\n                        }\n                      </TData>\n                      <TData\n                        highlight={\n                          cmVal === 1 ? \"hot\" : cmVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {cm}\n                      </TData>\n                      <TData\n                        highlight={\n                          cmVal === 1 ? \"hot\" : cmVal === 2 ? \"cold\" : \"none\"\n                        }\n                      ></TData>\n                      <TData\n                        highlight={\n                          smVal === 1 ? \"hot\" : smVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {Number(sm) / 1000}\n                      </TData>\n\n                      <TData\n                        highlight={\n                          smVal === 1 ? \"hot\" : smVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {i === 0 ? \"km\" : \"\"}\n                      </TData>\n                      <TData\n                        highlight={\n                          csVal === 1 ? \"hot\" : csVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {cs}\n                      </TData>\n\n                      <TData\n                        highlight={\n                          csVal === 1 ? \"hot\" : csVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {i === 0 ? \"%\" : \"\"}\n                      </TData>\n                      <TData\n                        highlight={\n                          ssVal === 1 ? \"hot\" : ssVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {ss}\n                      </TData>\n\n                      <TData\n                        highlight={\n                          ssVal === 1 ? \"hot\" : ssVal === 2 ? \"cold\" : \"none\"\n                        }\n                      >\n                        {i === 0 ? \"%\" : \"\"}\n                      </TData>\n                    </TRow>\n                  );\n                });\n            }}\n          />\n        </TBody>\n      </MainTable>\n      <LegendContainer>\n        <p>* have own custom metric</p>\n        <Legend>\n          <HotLegend>Hot Spot</HotLegend>\n          <ColdLegend>Cold Spot</ColdLegend>\n        </Legend>\n      </LegendContainer>\n    </div>\n  );\n}\n","import React, { useState, useContext } from \"react\";\nimport styled from \"styled-components\";\n\nimport Page from \"../components/page\";\nimport MapView from \"../components/bivar/mapView\";\nimport Table from \"../components/bivar/table\"\n\nimport Sparse from \"../utility/sparse\";\nimport MapZoom from \"../utility/mapZoom\";\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n`;\n\nconst width = 380;\nconst height = 250;\nconst mapsTranslate: [number, number] = [width / 2, height / 2];\nconst mapsScale = 500;\n\nconst MapSettings = {\n  width,\n  height,\n  translate: mapsTranslate,\n  scale: mapsScale,\n};\n\nconst Bivariate = () => {\n  const [selectedCounty, setSelectedCounty] = useState<[number, string]>([\n    -1,\n    \"\",\n  ]);\n\n  const [time, setTime] = useState<[number, number]>([0, 52]);\n\n  const [week, setWeek] = useState(0);\n  const [selectedState, setSelectedState] = useState<[number, string]>([\n    -1,\n    \"\",\n  ]);\n\n  return (\n    <Page selectedPage=\"Animation\">\n      <Container>\n        {/*<p>Week of {dates[week]}</p>*/}\n        <MapView\n          MapSettings={MapSettings}\n          selectedCounty={selectedCounty}\n          setSelectedCounty={setSelectedCounty}\n          time={time}\n          setTime={setTime}\n          week={week}\n          setWeek={setWeek}\n          selectedState={selectedState}\n          setSelectedState={setSelectedState}\n        />\n        <p>Clicking on a state on the map above will show the raw values for counties in that state that are displayed below. and other words that i know.</p>\n        {selectedState[0] !== -1 ? <Table selectedState={selectedState} week={week}/> : null}\n      </Container>\n    </Page>\n  );\n};\n\nexport default Bivariate;\n","import * as d3 from \"d3\"\n\nexport default class MapZoom {\n    active = d3.select(null);\n    path = null\n    g = null\n    width = 0\n    height = 0\n    currId = -1\n\n    constructor(path, g, width, height, id) {\n        this.path = path\n        this.g = g;\n        this.width = width\n        this.height = height\n        this.currId = id\n    }\n\n    /*\n        Zoom in from id\n    */\n    select(id: number) {\n        this.currId = id;\n\n        const clicked = this.g.select(`[stateFips='${id}']`);\n\n        // this.active.classed(\"active\", false);\n        // this.active = clicked.classed(\"active\", true);\n\n        let d;\n        clicked.attr('x', (_d, i) => {\n            d = _d\n        })\n\n        const [[x0, y0], [x1, y1]] = this.path.bounds(d);\n\n        const dx = x1 - x0;\n        const dy = y1 - y0;\n        const x = (x0 + x1) / 2;\n        const y = (y0 + y1) / 2;\n\n        const scaleNew = 0.8 / Math.max(dx / this.width, dy / this.height);\n        const translateNew = [this.width / 2 - scaleNew * x, this.height / 2 - scaleNew * y]\n\n        this.g\n            .transition()\n            .duration(650)\n            .attr(\"transform\", `translate(${translateNew}) scale(${scaleNew})`)\n\n        return scaleNew\n    }\n\n    /*\n        On click event handler,\n\n\n        not used, WON'T WORK ANYMORE\n    */\n    clicked(clicked, d) {\n        const stateId = clicked.getAttribute(\"id\")\n        // const states = d3.selectAll(`[id='${stateId}']`)\n\n        if (this.active.node() === clicked) {\n            return this.reset();\n        }\n\n        this.active.classed(\"active\", false);\n        this.active = d3.select(clicked).classed(\"active\", true);\n\n        const [[x0, y0], [x1, y1]] = this.path.bounds(d);\n\n        const dx = x1 - x0;\n        const dy = y1 - y0;\n        const x = (x0 + x1) / 2;\n        const y = (y0 + y1) / 2;\n\n        const scaleNew = 0.7 / Math.max(dx / this.width, dy / this.height);\n        const translateNew = [this.width / 2 - scaleNew * x, this.height / 2 - scaleNew * y]\n\n        this.g\n            .transition()\n            .duration(650)\n            .attr(\"transform\", `translate(${translateNew}) scale(${scaleNew})`)\n\n        return stateId\n    }\n\n    /*\n        Reset map view\n    */\n    reset() {\n        this.currId = \"\"\n        this.active.classed(\"active\", false);\n        this.active = d3.select(null);\n\n        this.g\n            .transition()\n            .duration(500)\n            .attr(\"transform\", `translate(0)`)\n    }\n}"],"sourceRoot":""}