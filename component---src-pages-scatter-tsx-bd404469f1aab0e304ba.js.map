{"version":3,"sources":["webpack://my-gatsby-site/./src/components/scatter/scatterPlot.tsx","webpack://my-gatsby-site/./src/components/scatter/scatterView.tsx","webpack://my-gatsby-site/./src/components/scatter/examples/explanationExample.tsx","webpack://my-gatsby-site/./src/components/scatter/examples/weekStartExample.tsx","webpack://my-gatsby-site/./src/components/scatter/examples/flatRegionsExample.tsx","webpack://my-gatsby-site/./src/components/scatter/stateSelection.tsx","webpack://my-gatsby-site/./src/components/scatter/dropdown.tsx","webpack://my-gatsby-site/./src/pages/scatter.tsx"],"names":["Container","styled","Title","MapContainer","getStateFips","fips","Number","String","slice","ScatterPlot","data","title","selectedState","labels","arrows","lines","size","margin","height","d3Container","useRef","useEffect","svg","d3","current","map_g","attr","append","xAxis","domain","range","call","yAxis","width","text","dataToPlot","Object","values","map","d","count","hot","cold","x","recent","y","reduce","result","key","push","getData","line","selectAll","sequential","enter","undefined","forEach","label","arrow","console","log","coldScale","hotScale","style","find","f","sel","arr","countiesInState","countiesInPoint","filter","_","i","avg","length","a","b","ref","ScatterView","useContext","LisaContext","mapData","mapTitles","ExplanationExample","includes","WeekStartExample","Math","floor","StateSelection","highlightedState","stateSelector","addState","translate","projection","scale","map_path","MapZoom","topojson","countiesMap","features","id","properties","name","on","this","getAttribute","DropDownContainer","ButtonContainer","Button","DropDown","statevals","statesMap","sort","localeCompare","htmlFor","onChange","value","currentTarget","selectedOptions","target","onClick","SelectionContainer","TextContainer","Text","Divider","Scatter","useState","setSelectedState","Array","mapZoom","setMapZoom","reset","m","currId","select","selectedPage","to"],"mappings":"kMAOMA,EAAYC,oBAAH,8DAAGA,CAAH,wEAQTC,EAAQD,mBAAH,0DAAGA,CAAH,eAILE,EAAeF,oBAAH,iEAAGA,CAAH,mBAkCZG,EAAe,SAACC,GACpB,OAAOC,OAAOC,OAAOF,GAAMG,MAAM,GAAI,KAoBxB,SAASC,EAAT,GAOL,IANRC,EAMQ,EANRA,KACAC,EAKQ,EALRA,MACAC,EAIQ,EAJRA,cACAC,EAGQ,EAHRA,OACAC,EAEQ,EAFRA,OACAC,EACQ,EADRA,MAEMC,EAAO,IAEPC,EAAS,CAAC,GAAI,IAEdC,EAASF,IAGTG,GAAcC,YAAO,MAuI3B,OArIAC,gBAAU,WACR,IAAMC,EAAMC,KAAUJ,EAAYK,SAE5BC,EAAQH,EACXI,KAAK,QAASV,GACdU,KAAK,SAAUV,KACfW,OAAO,KACPD,KAAK,QAAS,IACdA,KAAK,YALM,aAKoBT,EAAO,GAL3B,MAKkCA,EAAO,GAAK,IAL9C,KAORW,EAAQL,QAAiBM,OAAO,CAAC,EAAG,KAAKC,MAAM,CAAC,EAd1Cd,MAgBZS,EACGE,OAAO,KACPD,KAAK,YAFR,oBAGGK,KAAKR,MAAcK,IAEtB,IAAMI,EAAQT,QAAiBM,OAAO,CAAC,EAAG,KAAKC,MAAM,CAACZ,EAAQ,IAE9DO,EAAME,OAAO,KAAKI,KAAKR,MAAYS,IAEnCV,EACGK,OAAO,QACPD,KAAK,cAAe,OACpBA,KAAK,IAAKO,KACVP,KAAK,IAAKR,KACVgB,KAAK,eAERZ,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,KAAK,KACVA,KAAK,IAAK,IACVA,KAAK,KAAM,UACXA,KAAK,YAAa,eAClBQ,KAAK,SAER,IAAMC,EAzGM,SAACzB,GAAD,OACd0B,OAAOC,OACL3B,EACG4B,KAAI,SAACC,GAAM,MACUA,EAAEC,QAAfC,EADG,KACEC,EADF,KAEV,MAAO,CACLC,EAAGF,EAAMC,EAAOH,EAAEK,SAAS,GAAKL,EAAEK,SAAS,GAC3CC,EAAGJ,EAAMC,EAAOD,EAAMC,EACtBD,IAAKA,EAAMC,EACXrC,KAAMkC,EAAElC,SAGXyC,QAAO,SAACC,EAAD,GAAiC,IAAtBJ,EAAsB,EAAtBA,EAAGE,EAAmB,EAAnBA,EAAGxC,EAAgB,EAAhBA,KAAMoC,EAAU,EAAVA,IACvBO,EAASL,EAAN,IAAWE,EAapB,OAXIG,KAAOD,GACTA,EAAOC,GAAK3C,KAAK4C,KAAK5C,GACtB0C,EAAOC,GAAKP,IAAIQ,KAAKR,IAErBM,EAAOC,GAAO,CACZL,IACAE,IACAxC,KAAM,CAACA,GACPoC,IAAK,CAACA,IAGHM,IACN,KA8EcG,CAAQxC,GAErByC,EAAO5B,QAEVoB,GAAE,gBAAGA,EAAH,EAAGA,EAAH,OAAWf,EAAMe,MACnBE,GAAE,gBAAGA,EAAH,EAAGA,EAAH,OAAWb,EAAMa,MAItBpB,EACG2B,UAAU,WACV1C,KACCA,EAAK4B,KAAI,SAACC,GAAM,MACMA,EAAEC,QAAfC,EADO,KACFC,EADE,KAEd,MAAO,CACLhC,KAAM+B,EAAMC,EAAOH,EAAEc,WAAW,GAAKd,EAAEc,WAAW,GAClDZ,IAAKA,EAAMC,EACXrC,KAAMkC,EAAElC,UAIbiD,QACA3B,OAAO,QACPD,KAAK,QAAS,OACdA,KAAK,SAAU,QACfA,KAAK,OAAQ,QACbA,KAAK,eAAgB,KACrBA,KAAK,iBAAkB,KACvBA,KAAK,KAAK,SAACa,GAAD,OAAOY,EAAKZ,EAAE7B,SAE3Be,EACG2B,UAAU,OACV1C,KAAKyB,GACLmB,QACA3B,OAAO,UACPD,KAAK,QAAS,SACdA,KAAK,MAAM,gBAAGiB,EAAH,EAAGA,EAAH,OAAWf,EAAMe,MAC5BjB,KAAK,MAAM,gBAAGmB,EAAH,EAAGA,EAAH,OAAWb,EAAMa,MAC5BnB,KAAK,IAAK,QAEE6B,IAAX1C,GACFA,EAAO2C,SAAQ,SAAAC,GAAK,OAAIA,EAAMnC,WAEjBiC,IAAXzC,GACFA,EAAO0C,SAAQ,SAAAE,GAAK,OAAIA,EAAMpC,WAElBiC,IAAVxC,GACAU,EACC2B,UAAU,YACV1C,KAAKK,GACLuC,QACA3B,OAAO,QAEPD,KAAK,eAAgB,GACrBA,KAAK,iBAAkB,GACvBA,KAAK,SAAU,SACfA,KAAK,mBAAoB,OACzBA,KAAK,KAAK,SAAAa,GAET,OADAoB,QAAQC,IAAIrB,GACLY,EAAKZ,QAGjB,KAEHlB,gBAAU,WACR,IAAMwC,EAAYtC,MACZuC,EAAWvC,MAEjBA,KAAUJ,EAAYK,SACnB4B,UAAU,UACVW,MAAM,gBAAgB,YAAc,IAAX1D,EAAW,EAAXA,KACxB,OAA6B,IAAtBO,EAAc,SACwC2C,IAA3DlD,EAAK2D,MAAK,SAACC,GAAD,OAAO7D,EAAa6D,KAAOrD,EAAc,MACjD,EACA,MAELmD,MAAM,QAAQ,YAAmB,IAtIHG,EAJpBC,EA0IO1B,EAAgB,EAAhBA,IACV2B,EAD0B,EAAX/D,KACQiC,KAC3B,SAAC2B,GAAD,OAA6B,IAAtBrD,EAAc,IAAaR,EAAa6D,KAAOrD,EAAc,MAEhEyD,GA1IuBH,EA0IOE,EAAL3B,EAzIzB6B,QAAO,SAACC,EAAGC,GAAJ,OAAUN,EAAIM,OA0IrBC,GA/IGN,EA+IWE,EAAgBK,OAASL,EAAkB5B,GA9I1DK,QAAO,SAAC6B,EAAGC,GAAJ,OAAUD,EAAIC,KAAKT,EAAIO,OA+InC,OAAOD,EAAM,GAAMX,EAASW,GAAOZ,EAAU,EAAIY,MAGrDlD,KAAUJ,EAAYK,SACnB4B,UAAU,QACVW,MAAM,UAAU,YAAmB,IAAhB1D,EAAgB,EAAhBA,KAAMoC,EAAU,EAAVA,IACxB,OAAOrC,EAAaC,KAAUO,EAAc,GACxC6B,EACE,UACA,UACF,YAEP,CAAC7B,IAGF,gBAACZ,EAAD,KACE,gBAACE,EAAD,KAAQS,GACR,gBAACR,EAAD,CAAc0E,IAAK1D,K,cCxNnBnB,EAAYC,oBAAH,kEAAGA,CAAH,4EAOA,SAAS6E,EAAT,GAEL,IADRlE,EACQ,EADRA,cACQ,GACuBmE,gBAAWC,KAAlCC,EADA,EACAA,QAASC,EADT,EACSA,UACjB,OACE,gBAAC,EAAD,KACGA,EAAU5C,KAAI,SAAC3B,EAAO6D,GACrB,OACE,gBAAC/D,EAAD,CACEuC,IAAKwB,EACL7D,MAAOA,EACPC,cAAeA,EACfF,KAAMuE,EAAUA,EAAQT,GAAK,W,cCxB1B,SAASW,IAAqB,OAKvCJ,gBAAWC,KAL4B,IAGzCC,QAAU3C,EAH+B,yBAIzC4C,WAAYvE,EAJ6B,KAQrCD,GARqC,eAQ9B4B,EAAI0B,MAAK,mBAAuB,QAAvB,EAAG3D,SAoCnBU,EAAQL,EACX2C,WAAW,GACXf,KAAI,YAAc,IAAXK,EAAW,EAAXA,EACN,MAAO,CACL,CAAEA,IAAGE,EAAG,GACR,CAAEF,IAAGE,EAHU,EAARA,OAMVyB,QAAO,YAAgB,IAAZ3B,EAAY,KAAZA,EAAY,KACtB,MAAO,CAAC,EAAG,GAAI,GAAI,GAAI,IAAIyC,SAASzC,MAExC,OACE,gBAAClC,EAAD,CACEE,MAAOA,EACPD,KAAM,CAACA,GACPE,cAAe,CAAC,GAAI,WACpBC,OAAQ,CAlDG,SAACS,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,IACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,QAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,QAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,QACK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,SAkBNnB,MAAOA,IC7DE,SAASsE,IAAmB,OAKrCN,gBAAWC,KAL0B,IAGvCC,QAAsB3C,GAHiB,yBAIvC4C,UAA2BvE,GAJY,qBAQnCD,EAAO4B,EAAIgC,QAAO,gBAAGjE,EAAH,EAAGA,KAAH,OAA0C,IAA5BiF,KAAKC,MAAMlF,EAAO,QA2BxD,OACE,gBAACI,EAAD,CACEE,MAAOA,EACPD,KAAMA,EACNE,cAAe,CAAC,EAAG,cACnBC,OAAQ,CA9BG,SAACS,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,oBAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,wBAeNpB,OAAQ,CAbG,SAACQ,GAAD,OACbA,EACCK,OAAO,QACPD,KAAK,IAAKH,QAAU,CAAC,CAAC,IAAK,KAAM,CAAC,IAAK,QACvCG,KAAK,SAAU,SACfA,KAAK,OAAQ,WCjCH,SAAS2D,IAAmB,OAKrCN,gBAAWC,KAL0B,IAGvCC,QAAa3C,GAH0B,0BAIvC4C,WAAgBvE,GAJuB,WAQnCD,GARmC,UAQ5B4B,EAAIgC,QAAO,gBAAGjE,EAAH,EAAGA,KAAH,OAA0C,KAA5BiF,KAAKC,MAAMlF,EAAO,SA8FxD,OACE,gBAACI,EAAD,CACEE,MAAOA,EACPD,KAAMA,EACNE,cAAe,CAAC,GAAI,gBACpBC,OAAQ,CAjGG,SAACS,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,uBAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,kBAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,IACVA,KAAK,KAAM,UACXQ,KAAK,mBAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,KACVA,KAAK,KAAM,UACXQ,KAAK,iBAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,IACVA,KAAK,KAAM,UACXQ,KAAK,iBAEK,SAACZ,GAAD,OACbA,EACGK,OAAO,QACPD,KAAK,cAAe,UACpBA,KAAK,IAAK,KACVA,KAAK,IAAK,IACVA,KAAK,KAAM,UACXQ,KAAK,cA8CNpB,OAAQ,CA5CG,SAACQ,GAAD,OACbA,EACGK,OAAO,QACPD,KACC,IACAH,QAAU,CACR,CAAC,IAAK,KACN,CAAC,IAAK,QAGTG,KAAK,SAAU,SACfA,KAAK,OAAQ,QAEH,SAACJ,GAAD,OACbA,EACGK,OAAO,QACPD,KACC,IACAH,QAAU,CACR,CAAC,IAAK,KACN,CAAC,IAAK,QAGTG,KAAK,SAAU,SACfA,KAAK,OAAQ,QAEH,SAACJ,GAAD,OACbA,EACGK,OAAO,QACPD,KACC,IACAH,QAAU,CACR,CAAC,IAAK,IACN,CAAC,IAAK,QAGTG,KAAK,SAAU,SACfA,KAAK,OAAQ,W,kCClGd1B,EAAYC,oBAAH,qEAAGA,CAAH,wEAYTE,GAJQF,mBAAH,iEAAGA,CAAH,eAIUA,oBAAH,wEAAGA,CAAH,sEAcH,SAASuF,EAAT,GAIL,IAHRC,EAGQ,EAHRA,iBACAC,EAEQ,EAFRA,cACAC,EACQ,EADRA,SAIMC,EAA8B,CAAC3D,IAAWf,KAG1CC,GAAcC,YAAO,MAErByE,EAAatE,QAAeuE,MAJpB,KAIiCF,UAAUA,GACnDG,EAAWxE,QAAasE,WAAWA,GAwCzC,OAtCAxE,gBAAU,WACR,IAAMI,EAAQF,KACJJ,EAAYK,SACnBE,KAAK,QAbI,KAcTA,KAAK,SAbK,KAcVC,OAAO,KAEVgE,EAAS,IAAIK,IAAQD,EAAUtE,EAjBnB,IACC,IAgBwCgE,EAAiB,KAGtEhE,EACGE,OAAO,KACPoC,MAAM,SAAU,SAChBA,MAAM,eAAgB,SACtBA,MAAM,OAAQ,aACdX,UAAU,QACV1C,KAAKuF,KAAiBC,EAAaA,kBAA4BC,UAC/D7C,QACA3B,OAAO,QACPD,KAAK,IAAKqE,GACVrE,KAAK,aAAa,gBAAG0E,EAAH,EAAGA,GAAH,OAAY9F,OAAO8F,MACrC1E,KAAK,aAAa,qBAAG2E,WAAcC,UACrC,KAEHjF,gBAAU,WACRE,KAAUJ,EAAYK,SACnB4B,UAAU,QACVmD,GAAG,SAAS,WACXb,EAAc,CACZpF,OAAOkG,KAAKC,aAAa,cACzBD,KAAKC,aAAa,kBAGrB1C,MAAM,QAAS,WACd,OAAOzD,OAAOkG,KAAKC,aAAa,gBAAkBhB,EAAiB,GAAK,eAAiB,iBAE5F,CAACA,IAGF,gBAAC,EAAD,KACE,gBAAC,EAAD,CAAcZ,IAAK1D,K,g6OCtFnBuF,EAAoBzG,oBAAH,mEAAGA,CAAH,+BAKjB0G,EAAkB1G,oBAAH,iEAAGA,CAAH,mEAWf2G,EAAS3G,uBAAH,wDAAGA,CAAH,gDAMG,SAAS4G,EAAT,GAA2D,IAAvCnB,EAAuC,EAAvCA,cAAe9E,EAAwB,EAAxBA,cAC1CkG,EAAY,kBACbC,iBACD,gBAAiBT,EAAjB,EAAGD,WAAcC,KAAjB,OACG,CACC,SACA,SACA,OACA,cACA,iBACA,+BACA,+CACA,wBACAlB,SAASkB,OAZC,CAchB,CAAEF,IAAK,EAAGC,WAAY,CAAEC,KAAM,oBAC9BU,MAAK,SAACrC,EAAGC,GACT,OAAc,IAAVD,EAAEyB,IACI,GACW,IAAVxB,EAAEwB,GACJ,EAEFzB,EAAE0B,WAAWC,KAAKW,cAAcrC,EAAEyB,WAAWC,SAEtD,OACE,gBAACI,EAAD,KACE,yFACA,gBAACC,EAAD,KACE,2BACG,IACD,yBAAOO,QAAQ,UAAf,mBACC,GACD,0BACEd,GAAG,SACHe,SAAU,YAGJ,IAFaC,EAEb,EAFJC,cAAiBD,MACPE,EACN,EADJC,OAAUD,gBAEV5B,EAAc,CAACpF,OAAO8G,GAAQE,EAAgB,GAAGpF,QAEnDkF,MAAOxG,EAAc,IAEpBkG,EAAUxE,KAAI,YAAkC,IAA/B8D,EAA+B,EAA/BA,GAAkBE,EAAa,EAA3BD,WAAcC,KAClC,OACE,0BAAQc,MAAO9G,OAAO8F,GAAKpD,IAAKoD,GAC7BE,QAMX,gBAACM,EAAD,CAAQY,QAAS,kBAAM9B,EAAc,EAAE,EAAG,OAA1C,UAEF,gK,cChEA1F,EAAYC,oBAAH,8DAAGA,CAAH,uEAOTwH,EAAqBxH,oBAAH,uEAAGA,CAAH,yDAMlByH,EAAgBzH,oBAAH,kEAAGA,CAAH,uGAWb0H,EAAO1H,kBAAH,yDAAGA,CAAH,iBAGJ2H,EAAU3H,mBAAH,4DAAGA,CAAH,oFAOE,SAAS4H,IAAU,OACUC,cAA2B,EAClE,EACD,KAFKlH,EADyB,KACVmH,EADU,QAMFD,cAASE,MAAe,IAA/CC,EANyB,KAMhBC,EANgB,KAa1BxC,EAAgB,SAAC,EAErByC,GACG,IAFF/B,EAEE,KAFEE,EAEF,cADH6B,OAAiB,GAEjB,IAAMC,EAAIH,EAAQ,GAElB,OAAKE,GAAS/B,IAAOgC,EAAEC,SAAkB,IAARjC,GAK/BgC,EAAED,QACFJ,EAAiB,EAAE,EAAG,MACf,IANPK,EAAEE,OAAOlC,GACT2B,EAAiB,CAAC3B,EAAIE,KACf,IAQX,OACE,gBAAC,IAAD,CAAMiC,aAAa,WACjB,gBAAC,EAAD,KACE,gBAACb,EAAD,KACE,2CACA,gBAACC,EAAD,iDAC4C,IAC1C,gBAAC,KAAD,CAAMa,GAAG,WAAT,oCAFF,KAIA,gBAACb,EAAD,6eAWF,gBAACC,EAAD,MACA,gBAACH,EAAD,KACE,gBAACZ,EAAD,CACEnB,cAAeA,EACf9E,cAAeA,IAEjB,gBAAC4E,EAAD,CACEC,iBAAkB7E,EAClB8E,cAAeA,EACfC,SAnDO,SAACyC,GAChBH,EAAQ,GAAKG,EACbF,EAAWD,OAoDP,gBAACL,EAAD,MACA,gBAAC9C,EAAD,CAAalE,cAAeA,IAC5B,gBAACgH,EAAD,MACA,gBAACF,EAAD,KACE,gBAACC,EAAD,OAEF,gBAACxC,EAAD,MACA,gBAACE,EAAD,MACA,gBAAC,EAAD","file":"component---src-pages-scatter-tsx-bd404469f1aab0e304ba.js","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\n\nimport Sparse from \"../../utility/sparse\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  margin: 10px;\n`;\n\nconst Title = styled.h3`\n  margin: 0;\n`;\n\nconst MapContainer = styled.svg`\n  height: 330px;\n`;\n\nconst getData = (data) =>\n  Object.values(\n    data\n      .map((d) => {\n        const [hot, cold] = d.count();\n        return {\n          x: hot > cold ? d.recent()[0] : d.recent()[1],\n          y: hot > cold ? hot : cold,\n          hot: hot > cold,\n          fips: d.fips,\n        };\n      })\n      .reduce((result, { x, y, fips, hot }) => {\n        const key = `${x},${y}`;\n\n        if (key in result) {\n          result[key].fips.push(fips);\n          result[key].hot.push(hot);\n        } else {\n          result[key] = {\n            x,\n            y,\n            fips: [fips],\n            hot: [hot],\n          };\n        }\n        return result;\n      }, {})\n  );\n\nconst getStateFips = (fips: number): number => {\n  return Number(String(fips).slice(0, -3));\n};\n\ntype Props = {\n  title: string;\n  selectedState: [number, string];\n  data: Array<Sparse>;\n  labels?: Array<any>;\n  arrows?: Array<any>;\n  lines?: Array<any>;\n};\n\nconst average = (arr: Array<number>) => {\n  return arr.reduce((a, b) => a + b) / arr.length;\n};\n\nconst subset = (vals: Array<number>, sel: Array<boolean>) => {\n  return vals.filter((_, i) => sel[i]);\n};\n\nexport default function ScatterPlot({\n  data,\n  title,\n  selectedState,\n  labels,\n  arrows,\n  lines\n}: Props) {\n  const size = 380;\n  const scale = 1;\n  const margin = [50, 50];\n\n  const height = size - 2 * 50;\n  const width = size - 2 * 50;\n\n  const d3Container = useRef(null);\n\n  useEffect(() => {\n    const svg = d3.select(d3Container.current);\n\n    const map_g = svg\n      .attr(\"width\", size)\n      .attr(\"height\", size - 40)\n      .append(\"g\")\n      .attr(\"scale\", 10)\n      .attr(\"transform\", `translate(${margin[0]}, ${margin[1] - 40})`);\n\n    const xAxis = d3.scaleLinear().domain([0, 52]).range([0, width]);\n\n    map_g\n      .append(\"g\")\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(d3.axisBottom(xAxis));\n\n    const yAxis = d3.scaleLinear().domain([0, 52]).range([height, 0]);\n\n    map_g.append(\"g\").call(d3.axisLeft(yAxis));\n\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", width / 2 + 100)\n      .attr(\"y\", height + 85 - 40)\n      .text(\"Week Number\");\n\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", -10 - height / 2)\n      .attr(\"y\", 10)\n      .attr(\"dy\", \"0.75em\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .text(\"Count\");\n\n    const dataToPlot = getData(data);\n\n    const line = d3\n      .line()\n      .x(({ x }) => xAxis(x))\n      .y(({ y }) => yAxis(y));\n\n    // lines\n    // does all calculations at once then turns on later\n    map_g\n      .selectAll(\"myLines\")\n      .data(\n        data.map((d) => {\n          const [hot, cold] = d.count();\n          return {\n            data: hot > cold ? d.sequential(1) : d.sequential(2),\n            hot: hot > cold,\n            fips: d.fips,\n          };\n        })\n      )\n      .enter()\n      .append(\"path\")\n      .attr(\"class\", \"seq\")\n      .attr(\"stroke\", \"none\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke-width\", 1.5)\n      .attr(\"stroke-opacity\", 0.15)\n      .attr(\"d\", (d) => line(d.data));\n\n    map_g\n      .selectAll(\"dot\")\n      .data(dataToPlot)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", \"point\")\n      .attr(\"cx\", ({ x }) => xAxis(x))\n      .attr(\"cy\", ({ y }) => yAxis(y))\n      .attr(\"r\", 2);\n\n    if (labels !== undefined) {\n      labels.forEach(label => label(svg))\n    }\n    if (arrows !== undefined) {\n      arrows.forEach(arrow => arrow(svg))\n    }\n    if (lines !== undefined) {\n        map_g\n        .selectAll(\"divLines\")\n        .data(lines)\n        .enter()\n        .append(\"path\")\n        // .style(\"stroke-dasharray\", \"3, 3\")\n        .attr(\"stroke-width\", 2)\n        .attr(\"stroke-opacity\", 1)\n        .attr(\"stroke\", \"black\")\n        .attr(\"stroke-dasharray\", \"1,1\")\n        .attr(\"d\", d => {\n          console.log(d);\n          return line(d);\n        })\n    }\n  }, []);\n\n  useEffect(() => {\n    const coldScale = d3.interpolateBlues;\n    const hotScale = d3.interpolateReds;\n\n    d3.select(d3Container.current)\n      .selectAll(\".point\")\n      .style(\"fill-opacity\", ({ fips }) => {\n        return selectedState[0] === -1 ||\n          fips.find((f) => getStateFips(f) === selectedState[0]) !== undefined\n          ? 1\n          : 0.1;\n      })\n      .style(\"fill\", ({ hot, fips }) => {\n        const countiesInState = fips.map(\n          (f) => selectedState[0] === -1 || getStateFips(f) === selectedState[0]\n        );\n        const countiesInPoint = subset(hot, countiesInState);\n        const avg = average(countiesInPoint.length ? countiesInPoint : hot);\n        return avg > 0.5 ? hotScale(avg) : coldScale(1 - avg); // make sure 1 - avg never is 0\n      });\n\n    d3.select(d3Container.current)\n      .selectAll(\".seq\")\n      .style(\"stroke\", ({ fips, hot }) => {\n        return getStateFips(fips) === selectedState[0]\n          ? hot\n            ? \"#FF0000\"\n            : \"#0000FF\"\n          : \"none\";\n      });\n  }, [selectedState]);\n\n  return (\n    <Container>\n      <Title>{title}</Title>\n      <MapContainer ref={d3Container} />\n    </Container>\n  );\n}\n","import React, { useContext } from \"react\";\nimport styled from \"styled-components\";\n\nimport Sparse from \"../../utility/sparse\";\nimport ScatterPlot from \"./scatterPlot\";\nimport { LisaContext } from \"../../contexts/lisaContext\"\n\ntype Props = {\n  selectedState: [number, string];\n};\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: center;\n`;\n\nexport default function ScatterView({\n  selectedState\n}: Props) {\n  const { mapData, mapTitles } = useContext(LisaContext)\n  return (\n    <Container>\n      {mapTitles.map((title, i) => {\n        return (\n          <ScatterPlot\n            key={i}\n            title={title}\n            selectedState={selectedState}\n            data={mapData ? mapData[i] : null}\n          />\n        );\n      })}\n    </Container>\n  );\n}\n","import React, { Props, useContext } from \"react\";\nimport ScatterPlot from \"../scatterPlot\";\nimport { LisaContext } from \"../../../contexts/lisaContext\";\n\nimport * as d3 from \"d3\";\n\nexport default function ExplanationExample() {\n  // Only want the fourth map\n  const {\n    mapData: [map, _, __, ___],\n    mapTitles: [title, _1, __1, ___1],\n  } = useContext(LisaContext);\n\n  // Get values only for California\n  const data = map.find(({ fips }) => fips === 56029);\n\n  const label1 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 90)\n      .attr(\"y\", 270)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"(1)\"); // week 10\n\n  const label2 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 145)\n      .attr(\"y\", 270)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"(2)\"); // week 10\n\n  const label3 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 220)\n      .attr(\"y\", 270)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"(3)\"); // week 10\n  const label4 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 300)\n      .attr(\"y\", 270)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"(1)\"); // week 10\n  const lines = data\n    .sequential(2)\n    .map(({ x, y }) => {\n      return [\n        { x, y: 0 },\n        { x, y },\n      ];\n    })\n    .filter(([{ x }, _]) => {\n      return [0, 12, 23, 40, 52].includes(x);\n    });\n  return (\n    <ScatterPlot\n      title={title}\n      data={[data]}\n      selectedState={[56, \"Wyoming\"]}\n      labels={[label1, label2, label3, label4]}\n      lines={lines}\n    />\n  );\n}\n","import React, { useContext } from \"react\";\nimport ScatterPlot from \"../scatterPlot\";\nimport { LisaContext } from \"../../../contexts/lisaContext\";\n\nimport * as d3 from \"d3\";\n\nexport default function WeekStartExample() {\n  // Only want the fourth map\n  const {\n    mapData: [_, __, ___, map],\n    mapTitles: [_1, __1, ___1, title],\n  } = useContext(LisaContext);\n\n  // Get values only for California\n  const data = map.filter(({ fips }) => Math.floor(fips / 1000) === 6);\n\n  const label1 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 130)\n      .attr(\"y\", 120)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Mar 4, State of\"); // week 10\n\n  const label2 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 130)\n      .attr(\"y\", 140)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Emergency Declared\"); // week 10\n\n  const arrow1 = (svg) =>\n    svg\n    .append(\"path\")\n    .attr(\"d\", d3.line()([[125, 160], [105, 275]]))\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\")\n\n  return (\n    <ScatterPlot\n      title={title}\n      data={data}\n      selectedState={[6, \"California\"]}\n      labels={[label1, label2]}\n      arrows={[arrow1]}\n    />\n  );\n}\n","import React, { useContext } from \"react\";\nimport ScatterPlot from \"../scatterPlot\";\nimport { LisaContext } from \"../../../contexts/lisaContext\";\n\nimport * as d3 from \"d3\";\n\nexport default function WeekStartExample() {\n  // Only want the fourth map\n  const {\n    mapData: [_, map, __, ___],\n    mapTitles: [_1, title, __1, ___1],\n  } = useContext(LisaContext);\n\n  // Get values only for California\n  const data = map.filter(({ fips }) => Math.floor(fips / 1000) === 42);\n\n  const label1 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 115)\n      .attr(\"y\", 180)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Social Distancing,\"); // week 12\n\n  const label2 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 115)\n      .attr(\"y\", 200)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Schools Close\"); // week 12\n\n  const label3 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 160)\n      .attr(\"y\", 80)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Counties enter\"); // week 19\n\n  const label4 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 160)\n      .attr(\"y\", 100)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Yellow Phase\"); // week 19\n\n  const label5 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 280)\n      .attr(\"y\", 30)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"Stay-at-home\"); // week 46\n\n  const label6 = (svg) =>\n    svg\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", 280)\n      .attr(\"y\", 50)\n      .attr(\"dy\", \"0.75em\")\n      .text(\"advisory\"); // week 46\n\n  const arrow1 = (svg) =>\n    svg\n      .append(\"path\")\n      .attr(\n        \"d\",\n        d3.line()([\n          [115, 220],\n          [115, 275],\n        ])\n      )\n      .attr(\"stroke\", \"black\")\n      .attr(\"fill\", \"red\");\n\n  const arrow2 = (svg) =>\n    svg\n      .append(\"path\")\n      .attr(\n        \"d\",\n        d3.line()([\n          [160, 120],\n          [160, 260],\n        ])\n      )\n      .attr(\"stroke\", \"black\")\n      .attr(\"fill\", \"red\");\n\n  const arrow3 = (svg) =>\n    svg\n      .append(\"path\")\n      .attr(\n        \"d\",\n        d3.line()([\n          [280, 70],\n          [300, 240],\n        ])\n      )\n      .attr(\"stroke\", \"black\")\n      .attr(\"fill\", \"red\");\n  return (\n    <ScatterPlot\n      title={title}\n      data={data}\n      selectedState={[42, \"Pennsylvania\"]}\n      labels={[label1, label2, label3, label4, label5, label6]}\n      arrows={[arrow1, arrow2, arrow3]}\n    />\n  );\n}\n","import React, { useRef, useEffect } from \"react\";\nimport styled from \"styled-components\";\n\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\nimport MapZoom from \"../../utility/mapZoom\";\n\nimport countiesMap from \"us-atlas/counties-10m.json\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  margin: 10px;\n`;\n\nconst Title = styled.h3`\n  margin: 0;\n`;\n\nconst MapContainer = styled.svg`\n  g {\n    background-color: light-gray;\n    fill: red;\n  }\n  border: 1px solid black;\n`;\n\ntype Props = {\n  highlightedState: [number, string];\n  stateSelector: ([a, b]: [number, string]) => void;\n  addState: (m: MapZoom) => void;\n};\n\nexport default function StateSelection({\n  highlightedState,\n  stateSelector,\n  addState,\n}: Props) {\n  const width = 380;\n  const height = 250;\n  const translate: [number, number] = [width / 2, height / 2];\n  const scale = 500;\n\n  const d3Container = useRef(null);\n\n  const projection = d3.geoAlbers().scale(scale).translate(translate);\n  const map_path = d3.geoPath().projection(projection);\n\n  useEffect(() => {\n    const map_g = d3\n      .select(d3Container.current)\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .append(\"g\");\n\n    addState(new MapZoom(map_path, map_g, width, height, highlightedState[0]));\n\n    // States:\n    map_g\n      .append(\"g\")\n      .style(\"stroke\", \"black\")\n      .style(\"stroke-width\", \"0.5px\")\n      .style(\"fill\", \"#ffffffff\")\n      .selectAll(\"path\")\n      .data(topojson.feature(countiesMap, countiesMap.objects.states).features)\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", map_path as any)\n      .attr(\"stateFips\", ({ id }) => Number(id))\n      .attr(\"stateName\", ({ properties: { name } }) => name);\n  }, []);\n\n  useEffect(() => {\n    d3.select(d3Container.current)\n      .selectAll(\"path\")\n      .on(\"click\", function () {\n        stateSelector([\n          Number(this.getAttribute(\"stateFips\")),\n          this.getAttribute(\"stateName\"),\n        ]);\n      })\n      .style(\"fill\",  function () {\n        return Number(this.getAttribute(\"stateFips\")) === highlightedState[0] ? \"rgb(0,54,96)\" : \"#ffffffff\"\n      })\n  }, [highlightedState]);\n\n  return (\n    <Container>\n      <MapContainer ref={d3Container} />\n    </Container>\n  );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nimport statesMap from \"us-atlas/states-10m.json\";\nconst DropDownContainer = styled.div`\n  width: 400px;\n  padding: 10px;\n`;\n\nconst ButtonContainer = styled.div`\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n`;\n\ntype Props = {\n  selectedState: [number, string];\n  stateSelector: ([a, b]: [number, string]) => void;\n};\n\nconst Button = styled.button`\n  border-radius: 10px;\n  height: 30px;\n  width: 60px;\n`;\n\nexport default function DropDown({ stateSelector, selectedState }: Props) {\n  const statevals = [\n    ...statesMap.objects.states.geometries.filter(\n      ({ properties: { name } }) =>\n        ![\n          \"Alaska\",\n          \"Hawaii\",\n          \"Guam\",\n          \"Puerto Rico\",\n          \"American Samoa\",\n          \"United States Virgin Islands\",\n          \"Commonwealth of the Northern Mariana Islands\",\n          \"District of Columbia\",\n        ].includes(name)\n    ),\n    { id: -1, properties: { name: \"United States\" } },\n  ].sort((a, b) => {\n    if (a.id === -1) {\n      return -1;\n    } else if (b.id === -1) {\n      return 1;\n    }\n    return a.properties.name.localeCompare(b.properties.name);\n  });\n  return (\n    <DropDownContainer>\n      <p>Select a state from the drop down or by clicking on the map.</p>\n      <ButtonContainer>\n        <div>\n          {\" \"}\n          <label htmlFor=\"states\">Choose a State:</label>\n          {\"\"}\n          <select\n            id=\"states\"\n            onChange={({\n              currentTarget: { value },\n              target: { selectedOptions },\n            }) => {\n              stateSelector([Number(value), selectedOptions[0].text]);\n            }}\n            value={selectedState[0]}\n          >\n            {statevals.map(({ id, properties: { name } }) => {\n              return (\n                <option value={Number(id)} key={id}>\n                  {name}\n                </option>\n              );\n            })}\n          </select>\n        </div>\n        <Button onClick={() => stateSelector([-1, \"\"])}>Reset</Button>\n      </ButtonContainer>\n      <p>Selecting a state will highlight that states' counties in the scatter plot below and show the cumulative trajectory over the year.</p>\n    </DropDownContainer>\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport ScatterView from \"../components/scatter/scatterView\";\nimport Page from \"../components/page\";\n\nimport MapZoom from \"../utility/mapZoom\";\n\nimport ExplanationExample from \"../components/scatter/examples/explanationExample\";\nimport WeekStartExample from \"../components/scatter/examples/weekStartExample\";\nimport FlatRegionsExample from \"../components/scatter/examples/flatRegionsExample\";\nimport StateSelection from \"../components/scatter/stateSelection\";\nimport DropDown from \"../components/scatter/dropdown\";\nimport { Link } from \"gatsby\";\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n`;\n\nconst SelectionContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n`;\n\nconst TextContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: start;\n  width: 100%;\n\n  & > h1 {\n    margin: 5px 5px 0 5px;\n  }\n`;\n\nconst Text = styled.p`\n  margin: 5px;\n`;\nconst Divider = styled.hr`\n  width: 98%;\n  height: 1px;\n  background-color: black;\n  border-radius: 1px;\n  margin: 5px 10px;\n`;\nexport default function Scatter() {\n  const [selectedState, setSelectedState] = useState<[number, string]>([\n    -1,\n    \"\",\n  ]);\n\n  const [mapZoom, setMapZoom] = useState(Array<MapZoom>(1));\n\n  const addState = (m: MapZoom) => {\n    mapZoom[0] = m;\n    setMapZoom(mapZoom);\n  };\n\n  const stateSelector = (\n    [id, name]: [number, string],\n    reset: boolean = false\n  ) => {\n    const m = mapZoom[0];\n\n    if (!reset && id !== m.currId && id !== -1) {\n      m.select(id);\n      setSelectedState([id, name]);\n      return true;\n    } else {\n      m.reset();\n      setSelectedState([-1, \"\"]);\n      return false;\n    }\n  };\n\n  return (\n    <Page selectedPage=\"Scatter\">\n      <Container>\n        <TextContainer>\n          <h1>Scatter Plots</h1>\n          <Text>\n            This page provides an alternative view to{\" \"}\n            <Link to=\"/static\">the static choropleth plots page</Link>.\n          </Text>\n          <Text>\n            The scatter plots below show the number of times a county was a hot\n            spot or cold spot vs the last week number it was a significant\n            value. Each point on the scatter plot represents the counties at the\n            specified count and week number. Since multiple counties can be at\n            the same location, the point is color blue if the majority of the\n            counties were cold spots and red if the majority were hot spots. A\n            darker colored point shows a higher proportion of counties being hot\n            or cold spots.\n          </Text>\n        </TextContainer>\n        <Divider />\n        <SelectionContainer>\n          <DropDown\n            stateSelector={stateSelector}\n            selectedState={selectedState}\n          />\n          <StateSelection\n            highlightedState={selectedState}\n            stateSelector={stateSelector}\n            addState={addState}\n          />\n        </SelectionContainer>\n        <Divider />\n        <ScatterView selectedState={selectedState} />\n        <Divider />\n        <TextContainer>\n          <Text></Text>\n        </TextContainer>\n        <ExplanationExample/>\n        <WeekStartExample />\n        <FlatRegionsExample />\n      </Container>\n    </Page>\n  );\n}\n"],"sourceRoot":""}