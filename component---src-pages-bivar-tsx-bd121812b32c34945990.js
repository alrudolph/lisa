(self.webpackChunkmy_gatsby_site=self.webpackChunkmy_gatsby_site||[]).push([[10],{5656:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return R}});var a=n(7294),i=n(9925),r=n(8673),l=n(5743),o=n(6169),c=n(6690),s=n(1329),d=n(4863),u=i.ZP.div.withConfig({displayName:"map__Container",componentId:"tmzwc-0"})(["display:flex;flex-direction:column;align-items:center;margin:10px;"]),h=i.ZP.h3.withConfig({displayName:"map__Title",componentId:"tmzwc-1"})(["margin:0;"]),p=i.ZP.svg.withConfig({displayName:"map__MapContainer",componentId:"tmzwc-2"})(["g{background-color:light-gray;fill:red;}border:1px solid ",";"],(function(t){return t.border?"black":"white"})),m=function(t){return Number(String(t).slice(0,-3))},f=function(t){var e=t.title,n=t.countiesMap,i=(t.highlightedCounty,t.countySelector,t.data),r=(t.time,t.MapSettings),l=t.weekNum,o=t.past,f=t.addState,g=t.stateSelector,b=t.selectedState,w=r.scale,y=r.translate,v=r.width,x=r.height,k=(0,a.useRef)(null),E=c.FWi().scale(w).translate(y),C=c.l49().projection(E);return(0,a.useEffect)((function(){var t=c.Ys(k.current).attr("width",v).attr("height",x).append("g");f(new d.Z(C,t,v,x,b[0])),t.append("g").style("stroke","black").style("stroke-width","0.5px").style("fill","#ffffffff").selectAll("path").data(s.zL(n,n.objects.states).features).enter().append("path").attr("d",C).attr("stateFips",(function(t){var e=t.id;return Number(e)})),t.append("g").selectAll("path").data(s.zL(n,n.objects.counties).features).enter().append("path").attr("d",C).attr("stateName",(function(t){var e=t.id;return n.objects.states.geometries.filter((function(t){return m(e)===Number(t.id)}))[0].properties.name})).attr("id",(function(t){var e=t.id;return"c"+Number(e)})).attr("class","cboundary").style("fill","#00000000")}),[]),(0,a.useEffect)((function(){i.forEach((function(t){var e,n,a=t.getLast(l),i=a.curr,r=a.last,s=a.weeks;i&&0!==i?(e=1===i?"#fa5a50":"#5768ac",n=1):(e="#00000000",1===r?e="#ff0000":2===r&&(e="#0000ff"),n=o&&r>0&&s>0?Math.pow(4,-s):0),n*=Math.pow(1/4,1-Number(m(t.fips)===b[0]||-1===b[0]));var d=c.Ys(k.current).select("#c"+t.fips);d.style("fill",e),d.style("fill-opacity",n)}))}),[l,o,b]),(0,a.useEffect)((function(){c.Ys(k.current).selectAll(".cboundary").on("click",(function(t,e){var n=t.currentTarget,a=e.id;g([m(a),n.getAttribute("stateName")])}))}),[b]),a.createElement(u,null,a.createElement(h,null,e),a.createElement(p,{ref:k,border:-1!==b[0]}))},g=n(7329),b=n(4449),w=i.ZP.div.withConfig({displayName:"timeline__Container",componentId:"pa4pje-0"})(["width:700px;height:150px;"]),y=i.ZP.svg.withConfig({displayName:"timeline__Slider",componentId:"pa4pje-1"})(["width:100%;height:90px;"]),v=i.ZP.div.withConfig({displayName:"timeline__ButtonArea",componentId:"pa4pje-2"})(["display:flex;width:100%;justify-content:center;*{margin:20px;}"]),x=function(t){return new Date(t+" PST")},k=function(t,e){return new Date(t.getTime()+864e5*e)},E=function(t){var e=t.week,n=t.setWeek,i=t.playing,r=t.setPlaying,l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=(0,a.useContext)(b.W).map((function(t){return x(t)})),s=(0,g.Z)(Array(365).keys()).map((function(t){return{d:k(o[0],t),i:t}})).filter((function(t){return 1===t.d.getDate()})),d=(0,a.useRef)(null),u=c.Xf().domain([o[0],o[o.length-1]]).range([0,600]).clamp(!0),h=function(t){var e;t instanceof Date?(e=(0,g.Z)(Array(o.length).keys()).find((function(e){return o[e]>t||e===o.length-1||o[e]>=t&&0===e})),n(e)):e=t;var a=o[e],i=e+1<o.length?k(o[e+1],-1):x("2020-12-27");c.Ys(d.current).select("#handle").attr("cx",u(a)),c.Ys(d.current).select("#label").attr("x",u(a)).text(a.getMonth()+1+"/"+a.getDate()+" - "+(i.getMonth()+1)+"/"+i.getDate())};return(0,a.useEffect)((function(){var t=c.Ys(d.current).append("svg").attr("width",700).attr("height",100).append("g").attr("transform","translate(55, 50)");t.insert("g").selectAll("text").data(s).enter().append("text").attr("x",(function(t){var e=t.d;return u(e)})).attr("y",30).attr("text-anchor","middle").text((function(t){var e=t.d;return l[e.getMonth()]})),t.append("text").attr("x",u(u.invert(600))).attr("y",30).text("2020");t.insert("circle").attr("id","handle").attr("r",9),t.append("text").attr("id","label").attr("text-anchor","middle").attr("transform","translate(0,-15)");t.append("line").attr("stroke","black").attr("stroke-width","10px").attr("stroke-opacity",.3).attr("stroke-linecap","round").attr("x1",u.range()[0]).attr("x2",u.range()[1]).select((function(){return this.parentNode.appendChild(this.cloneNode(!0))})).attr("stroke-width","100px").attr("stroke","transparent").call(c.ohM().on("start.interrupt",(function(){return t.interrupt()})).on("start drag",(function(t){r(!1),h(u.invert(t.x))})))}),[]),(0,a.useEffect)((function(){h(e)}),[e]),a.createElement(w,null,a.createElement(y,{ref:d}),a.createElement(v,null,a.createElement("button",{onClick:function(){e>0&&n(e-1),r(!1)}},"Prev"),a.createElement("button",{onClick:function(){r(!i)}},i?"Pause":"Play"),a.createElement("button",{onClick:function(){e<51&&n(e+1),r(!1)}},"Next")))},C=i.ZP.div.withConfig({displayName:"mapView__Container",componentId:"sc-852ciw-0"})(["display:flex;flex-direction:column;align-items:center;"]),S=(i.ZP.p.withConfig({displayName:"mapView__Text",componentId:"sc-852ciw-1"})(["margin:0;width:100px;white-space:nowrap;"]),i.ZP.div.withConfig({displayName:"mapView__MapContainer",componentId:"sc-852ciw-2"})(["display:flex;flex-direction:row;justify-content:center;width:100%;flex-wrap:wrap;@media (max-width:770px){flex-wrap:wrap;}"]));function _(t){var e=t.selectedCounty,n=t.setSelectedCounty,i=t.MapSettings,r=t.time,c=(t.setTime,t.week),s=t.setWeek,d=t.selectedState,u=t.setSelectedState,h=(0,a.useState)(!1),p=h[0],m=h[1],g=(0,a.useContext)(o.z),b=g.mapData,w=g.mapTitles,y=(0,a.useState)(!1),v=y[0],x=y[1],k=(0,a.useState)(Array(4)),_=k[0],N=k[1],P=function(t,e){var n,a=t[0],i=t[1];return void 0===e&&(e=!1),_.forEach((function(t){e||a===t.currId||-1===a?(t.reset(),n=!1):(t.select(a),n=!0)})),n?(u([a,i]),!0):(u([-1,""]),!1)};return(0,a.useEffect)((function(){if(v){var t=setInterval((function(){c<51&&s(c+1)}),500);return function(){return clearInterval(t)}}}),[v,c]),a.createElement(C,null,a.createElement("div",null,a.createElement("form",null,a.createElement("input",{type:"checkbox",id:"1",name:"here",value:"sad",onChange:function(){return m(!p)}}),a.createElement("label",{htmlFor:"1"},"Show Past Values"))),a.createElement(S,null,w.map((function(t,o){return a.createElement(f,{key:o,title:t,countiesMap:l,highlightedCounty:e,countySelector:n,selectedState:d,stateSelector:P,addState:function(t){return function(t,e){_[e]=t,N(_)}(t,o)},time:r,data:b?b[o]:null,weekNum:c,MapSettings:i,past:p})}))),a.createElement(E,{week:c,setWeek:s,playing:v,setPlaying:x}))}var N=n(5444),P=i.ZP.table.withConfig({displayName:"table__MainTable",componentId:"b45yk0-0"})(["border-collapse:collapse;width:760px;"]),I=i.ZP.thead.withConfig({displayName:"table__THead",componentId:"b45yk0-1"})([""]),Z=i.ZP.th.withConfig({displayName:"table__THGroup",componentId:"b45yk0-2"})(["text-align:center;",""],(function(t){return t.underLine?"border-bottom: 1px solid black; border-left: 20px solid white; border-right: 20px solid white;":null})),A=i.ZP.th.withConfig({displayName:"table__TH",componentId:"b45yk0-3"})(["text-align:center;border-bottom:1px solid black;"]),M=i.ZP.td.withConfig({displayName:"table__TData",componentId:"b45yk0-4"})(["background-color:",";padding:0;margin:0;"],(function(t){var e=t.highlight;return"hot"===e?"#5768acAA":"cold"===e?"#fa5a50AA":"#FFFFFF00"})),T=i.ZP.tr.withConfig({displayName:"table__TRow",componentId:"b45yk0-5"})([""]),j=i.ZP.tbody.withConfig({displayName:"table__TBody",componentId:"b45yk0-6"})([""," > *:nth-child(2n+1){width:10px;padding:2px;}"," > *{text-align:right;}& > ",":hover{background-color:#d3d3d3;}"," > *:nth-child(2n){width:100px;}"," > *:nth-child(1){width:130px;text-align:left;border-right:1px solid black;}"," > *:nth-child(3){}"," > *:nth-child(7){}"," > *:nth-child(5){border-right:1px solid black;}","{border-bottom:1px solid rgb(205,205,205);}",":last-child{border-bottom:1px solid black;}"],T,T,T,T,T,T,T,T,T,T),F=i.ZP.p.withConfig({displayName:"table__ColdLegend",componentId:"b45yk0-7"})(["background-color:#fa5a50AA;"]),L=i.ZP.p.withConfig({displayName:"table__HotLegend",componentId:"b45yk0-8"})(["background-color:#5768acAA;"]),D=i.ZP.div.withConfig({displayName:"table__LegendContainer",componentId:"b45yk0-9"})(["display:flex;justify-content:flex-end;"]),Y=i.ZP.div.withConfig({displayName:"table__Legend",componentId:"b45yk0-10"})(["display:flex;& > *{margin:5px;padding:5px;}"]);function z(t){var e=t.selectedState,n=t.week,i=(0,a.useContext)(o.z),r=i.mapData;i.mapTitles;return a.createElement("div",null,a.createElement(P,null,a.createElement(I,null,a.createElement(T,null,a.createElement(Z,{underLine:!1},"Counties of"),a.createElement(Z,{colSpan:4,underLine:!0},"Mobility"),a.createElement(Z,{colSpan:4,underLine:!0},"Sheltered")),a.createElement(T,null,a.createElement(A,null,e[1]),a.createElement(A,{colSpan:2},"Cuebiq*"),a.createElement(A,{colSpan:2},"SafeGraph"),a.createElement(A,{colSpan:2},"Cuebiq"),a.createElement(A,{colSpan:2},"SafeGraph"))),a.createElement(j,null,a.createElement(N.i1,{query:"2834450407",render:function(t){return t.allRawCsv.nodes.filter((function(t){return Number(t.week)-1===n&&(a=t.fips,Number(String(a).slice(0,-3))===e[0]);var a})).map((function(t,e){var i=t.fips,o=t.cm,c=t.cs,s=t.sm,d=t.ss,u=r[0].find((function(t){return t.fips===Number(i)})),h=void 0!==u?u.get(n):0,p=r[1].find((function(t){return t.fips===Number(i)})),m=void 0!==p?p.get(n):0,f=r[2].find((function(t){return t.fips===Number(i)})),g=void 0!==f?f.get(n):0,b=r[3].find((function(t){return t.fips===Number(i)})),w=void 0!==b?b.get(n):0;return a.createElement(T,{key:i},a.createElement(M,{highlight:"none"},l.objects.counties.geometries.find((function(t){var e=t.id;return Number(e)===Number(i)})).properties.name),a.createElement(M,{highlight:1===h?"hot":2===h?"cold":"none"},o),a.createElement(M,{highlight:1===h?"hot":2===h?"cold":"none"}),a.createElement(M,{highlight:1===g?"hot":2===g?"cold":"none"},Number(s)/1e3),a.createElement(M,{highlight:1===g?"hot":2===g?"cold":"none"},0===e?"km":""),a.createElement(M,{highlight:1===m?"hot":2===m?"cold":"none"},c),a.createElement(M,{highlight:1===m?"hot":2===m?"cold":"none"},0===e?"%":""),a.createElement(M,{highlight:1===w?"hot":2===w?"cold":"none"},d),a.createElement(M,{highlight:1===w?"hot":2===w?"cold":"none"},0===e?"%":""))}))}}))),a.createElement(D,null,a.createElement("p",null,"* have own custom metric"),a.createElement(Y,null,a.createElement(L,null,"Hot Spot"),a.createElement(F,null,"Cold Spot"))))}var W=i.ZP.div.withConfig({displayName:"bivar__Container",componentId:"tzh0o4-0"})(["width:100%;display:flex;align-items:center;flex-direction:column;"]),H={width:380,height:250,translate:[190,125],scale:500},R=function(){var t=(0,a.useState)([-1,""]),e=t[0],n=t[1],i=(0,a.useState)([0,52]),l=i[0],o=i[1],c=(0,a.useState)(0),s=c[0],d=c[1],u=(0,a.useState)([-1,""]),h=u[0],p=u[1];return a.createElement(r.Z,{selectedPage:"Animation"},a.createElement(W,null,a.createElement(_,{MapSettings:H,selectedCounty:e,setSelectedCounty:n,time:l,setTime:o,week:s,setWeek:d,selectedState:h,setSelectedState:p}),a.createElement("p",null,"Clicking on a state on the map above will show the raw values for counties in that state that are displayed below. and other words that i know."),-1!==h[0]?a.createElement(z,{selectedState:h,week:s}):null))}},4863:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var a=n(6690),i=function(){function t(t,e,n,i,r){this.active=a.Ys(null),this.path=null,this.g=null,this.width=0,this.height=0,this.currId=-1,this.path=t,this.g=e,this.width=n,this.height=i,this.currId=r}var e=t.prototype;return e.select=function(t){var e;this.currId=t,this.g.select("[stateFips='"+t+"']").attr("x",(function(t,n){e=t}));var n=this.path.bounds(e),a=n[0],i=a[0],r=a[1],l=n[1],o=l[0],c=l[1],s=o-i,d=c-r,u=(i+o)/2,h=(r+c)/2,p=.8/Math.max(s/this.width,d/this.height),m=[this.width/2-p*u,this.height/2-p*h];return this.g.transition().duration(650).attr("transform","translate("+m+") scale("+p+")"),p},e.clicked=function(t,e){var n=t.getAttribute("id");if(this.active.node()===t)return this.reset();this.active.classed("active",!1),this.active=a.Ys(t).classed("active",!0);var i=this.path.bounds(e),r=i[0],l=r[0],o=r[1],c=i[1],s=c[0],d=c[1],u=s-l,h=d-o,p=(l+s)/2,m=(o+d)/2,f=.7/Math.max(u/this.width,h/this.height),g=[this.width/2-f*p,this.height/2-f*m];return this.g.transition().duration(650).attr("transform","translate("+g+") scale("+f+")"),n},e.reset=function(){this.currId="",this.active.classed("active",!1),this.active=a.Ys(null),this.g.transition().duration(500).attr("transform","translate(0)")},t}()}}]);
//# sourceMappingURL=component---src-pages-bivar-tsx-bd121812b32c34945990.js.map